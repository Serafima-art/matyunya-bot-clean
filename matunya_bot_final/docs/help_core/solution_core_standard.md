–î–æ–∫—É–º–µ–Ω—Ç ‚Ññ1: "–ì–û–°–¢-2025: –°—Ç–∞–Ω–¥–∞—Ä—Ç solution_core"

# –ì–û–°–¢-2026: –°—Ç–∞–Ω–¥–∞—Ä—Ç –°—Ç—Ä—É–∫—Ç—É—Ä—ã solution_core v2.2: 

## 1. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

`solution_core` ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å–ª–æ–≤–∞—Ä—å (dict), –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –æ—Ç –ª—é–±–æ–≥–æ "–†–µ—à–∞—Ç–µ–ª—è" (`solver`) –∫ "–û–∂–∏–≤–∏—Ç–µ–ª—é" (`humanizer`) –∏ –¥—Ä—É–≥–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º —Å–∏—Å—Ç–µ–º—ã.

## 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ v2.1

```python
{
    # --- –ë–õ–û–ö 1: –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø –ò –ú–ï–¢–ê–î–ê–ù–ù–´–ï ---
    "question_id": str,
    "question_group": str,

    # --- –ë–õ–û–ö 2: –ü–ï–î–ê–ì–û–ì–ò–ß–ï–°–ö–ê–Ø –ß–ê–°–¢–¨ ---
    "explanation_idea": str,
    
    # --- –ë–õ–û–ö 3: –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–û–ï –Ø–î–†–û ---
    "calculation_steps": [
        {
            "step_number": int,
            "description": str,
            "formula_representation": Optional[str],
            "calculation_result": str,
            "result_unit": Optional[str],
            "visual_instruction": Optional[{
                "source_image": str,
                "tool": str, # e.g., "highlighter", "add_arrow"
                "params": dict
            }]
        },
    ],

    # --- –ë–õ–û–ö 4: –ò–¢–û–ì–û–í–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢ ---
    "final_answer": {
        "value_machine": Union[float, int, str],
        "value_display": str,
        "unit": Optional[str],
        "visual_instruction": Optional[{...}] # –¢–∞ –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
    },
    
    # --- –ë–õ–û–ö 5: –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø ---
    "validation_code": Optional[str],
    "hints": List[str]
}
3. –û–ø–∏—Å–∞–Ω–∏–µ –ü–æ–ª–µ–π
question_id (str): –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–¥—Ç–∏–ø–∞. (e.g., "tires_q1_min_width", "11_match_signs_a_c"). –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.
question_group (str): –û–±—â–∞—è –≥—Ä—É–ø–ø–∞ –∑–∞–¥–∞–Ω–∏–π. (e.g., "Q1_TABLE", "SIGNS_A_C"). –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.
explanation_idea (str): –ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è —Ä–µ—à–µ–Ω–∏—è –≤ 1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.
calculation_steps (List[dict]): –°–ø–∏—Å–æ–∫ —à–∞–≥–æ–≤ —Ä–µ—à–µ–Ω–∏—è. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.
step_number (int): –ù–æ–º–µ—Ä —à–∞–≥–∞.
description (str): –¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è.
formula_representation (Optional[str]): –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º—É–ª—ã (e.g., "D = 2H + d * 25.4").
calculation_result (str): –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ (e.g., "2*55 + 17*25.4 = 541.8 –º–º").
result_unit (Optional[str]): –ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —ç—Ç–æ–≥–æ —à–∞–≥–∞.
visual_instruction (Optional[dict]): –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è "–í–∏–∑—É–∞–ª–∏–∑–∞—Ç–æ—Ä–∞".
source_image (str): –ü—É—Ç—å –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é.
tool (str): –ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (e.g., "highlighter", "add_arrow").
params (dict): –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.
final_answer (dict): –ò—Ç–æ–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.
value_machine (Union[float, int, str]): –û—Ç–≤–µ—Ç –≤ –º–∞—à–∏–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏.
value_display (str): –û—Ç–≤–µ—Ç –≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è –ø–æ–∫–∞–∑–∞ —É—á–µ–Ω–∏–∫—É.
unit (Optional[str]): –§–∏–Ω–∞–ª—å–Ω–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è.
visual_instruction (Optional[dict]): –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è.
validation_code (Optional[str]): Python-–∫–æ–¥ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏.
hints (List[str]): –°–ø–∏—Å–æ–∫ –ø–æ–ª–µ–∑–Ω—ã—Ö —Å–æ–≤–µ—Ç–æ–≤. –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.



. "–ì–û–°–¢-2026: –°—Ç–∞–Ω–¥–∞—Ä—Ç solution_core" (–ù–µ–∏–∑–º–µ–Ω–µ–Ω)
–≠—Ç–æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∑—ã–±–ª–µ–º—ã–º —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã. –õ—é–±–æ–π "–†–µ—à–∞—Ç–µ–ª—å" (solver) –æ–±—è–∑–∞–Ω –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —ç—Ç–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ. –≠—Ç–æ "—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —è–∑—ã–∫", –∫–æ—Ç–æ—Ä—ã–π –ø–æ–Ω–∏–º–∞—é—Ç –æ–±–∞ –Ω–∞—à–∏—Ö "–∫–æ–Ω–≤–µ–π–µ—Ä–∞" –∏ —Å–∏—Å—Ç–µ–º–∞ "–ü–µ—Ä–µ–¥–∞—á–∏ –≠—Å—Ç–∞—Ñ–µ—Ç—ã".
–ö—Ä–∞—Ç–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:
code
Python
{
    "question_id": str,
    "question_group": str,
    "explanation_idea": str,
    "calculation_steps": [ { ... } ],
    "final_answer": { ... },
    "hints": List[str],
    "validation_code": Optional[str],     // –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –±—É–¥—É—â–µ–≥–æ
    "visual_instruction": Optional[dict]  // –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –±—É–¥—É—â–µ–≥–æ
}

–†–∞–∑–¥–µ–ª 3: –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ø–¥—Ä–æ (calculation_steps)
calculation_steps ‚Äî —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –≥–¥–µ –∫–∞–∂–¥—ã–π —Å–ª–æ–≤–∞—Ä—å –æ–ø–∏—Å—ã–≤–∞–µ—Ç –æ–¥–∏–Ω –ª–æ–≥–∏—á–µ—Å–∫–∏–π —à–∞–≥ —Ä–µ—à–µ–Ω–∏—è.
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞:
code
Python
{
    "step_number": int,
    "description": str,
    
    # --- –ë–õ–û–ö –§–û–†–ú–£–õ (–æ–¥–Ω–æ –∏–∑ –ø–æ–ª–µ–π –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –µ—Å–ª–∏ —à–∞–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞—Ç–µ–º–∞—Ç–∏–∫—É) ---
    "formula_representation": Optional[str], # –î–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Ñ–æ—Ä–º—É–ª –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–π
    "formula_general": Optional[str],      # ‚òÖ‚òÖ‚òÖ –ù–û–í–û–ï ‚òÖ‚òÖ‚òÖ –î–ª—è –æ–±—â–∏—Ö —Ñ–æ—Ä–º—É–ª (D = b¬≤ - 4ac)
    "formula_calculation": Optional[str],  # ‚òÖ‚òÖ‚òÖ –ù–û–í–û–ï ‚òÖ‚òÖ‚òÖ –î–ª—è —Ñ–æ—Ä–º—É–ª —Å –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏
    
    "calculation_result": Optional[str],
    "result_unit": Optional[str]
    # "visual_instruction" –æ—Å—Ç–∞–µ—Ç—Å—è –¥–ª—è –±—É–¥—É—â–µ–≥–æ
}
–û–ø–∏—Å–∞–Ω–∏–µ –ù–æ–≤—ã—Ö –ü–æ–ª–µ–π:
formula_general (Optional[str]): –û–±—â–∞—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω–æ–º —à–∞–≥–µ. –ü—Ä–∏–º–µ—Ä: "D = b¬≤ - 4ac".
formula_calculation (Optional[str]): –¢–∞ –∂–µ —Ñ–æ—Ä–º—É–ª–∞, –Ω–æ —Å –ø–æ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –≤ –Ω–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ —á–∏—Å–ª–∞–º–∏ –∏–∑ –∑–∞–¥–∞—á–∏ –∏, –≤–æ–∑–º–æ–∂–Ω–æ, —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º. –ü—Ä–∏–º–µ—Ä: "D = (5)¬≤ - 4¬∑2¬∑(-3) = 49".
–ö–∞–∫ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
"–†–µ—à–∞—Ç–µ–ª—å" –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–∏ –ø–æ–ª—è –¥–ª—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –∫–∞–∫ –º—ã –∏ –¥–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å –≤ "–ó–æ–ª–æ—Ç–æ–º –≠—Ç–∞–ª–æ–Ω–µ". "–û—á–µ–ª–æ–≤–µ—á–∏–≤–∞—Ç–µ–ª—å" –±—É–¥–µ—Ç –æ–∂–∏–¥–∞—Ç—å —ç—Ç–∏ –∫–ª—é—á–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º.


4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –°—Ü–µ–Ω–∞—Ä–∏–π (–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω)
–£—á–µ–Ω–∏–∫ –Ω–∞–∂–∏–º–∞–µ—Ç üÜò –ü–æ–º–æ—â—å.
–°–∏—Å—Ç–µ–º–∞ (–ø–æ –æ–¥–Ω–æ–º—É –∏–∑ –¥–≤—É—Ö "–∫–æ–Ω–≤–µ–π–µ—Ä–æ–≤") –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ü–∞–Ω–µ–ª—å –ü–æ–º–æ—â–∏, –ø–æ–º–µ—â–∞—è –µ–µ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—é help_panels.
–ü–æ–¥ –ø–∞–Ω–µ–ª—å—é –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–∞–º–∏ ‚ùå –°–∫—Ä—ã—Ç—å –ø–æ–º–æ—â—å –∏ ‚ùì –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å.
–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ ‚ùì –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –¥–∏–∞–ª–æ–≥–æ–≤—ã–π –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä (gpt_dialog_control_handler.py), –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ GPState.in_dialog –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–π –¥–∞–ª—å–Ω–µ–π—à–µ–π –ø–µ—Ä–µ–ø–∏—Å–∫–æ–π.
–í—Å—è –ø–µ—Ä–µ–ø–∏—Å–∫–∞ —Å GPT –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π dialog_messages –∏ —É–¥–∞–ª—è–µ—Ç—Å—è –ø–æ –∫–Ω–æ–ø–∫–µ ‚úÖ –í—Å—ë –ø–æ–Ω—è—Ç–Ω–æ, —Å–ø–∞—Å–∏–±–æ!, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è –æ—Å–Ω–æ–≤–Ω—É—é –ü–∞–Ω–µ–ª—å –ü–æ–º–æ—â–∏.
5. –ü–ª–∞–Ω—ã –Ω–∞ –ë—É–¥—É—â–µ–µ
"–û–ø–µ—Ä–∞—Ü–∏—è '–°–ø–æ–π–ª–µ—Ä'": –í–Ω–µ–¥—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–≥–∞ <tg-spoiler> –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –≤ –æ–±–æ–∏—Ö "–∫–æ–Ω–≤–µ–π–µ—Ä–∞—Ö", —á—Ç–æ–±—ã —É—Å–∏–ª–∏—Ç—å –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–π —ç—Ñ—Ñ–µ–∫—Ç, –∫–∞–∫ –∏ –±—ã–ª–æ –∑–∞–¥—É–º–∞–Ω–æ –≤ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏.
