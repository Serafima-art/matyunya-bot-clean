"""
–®–∞–±–ª–æ–Ω—ã –¥–ª—è –≥—É–º–∞–Ω–∏–∑–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏–π –ó–∞–¥–∞–Ω–∏—è 15 (–ü–ª–∞–Ω–∏–º–µ—Ç—Ä–∏—è).
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –°—Ü–µ–Ω–∞—Ä–∏–∏ (Narrative), –ø–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è.
"""

from __future__ import annotations
from typing import Any, Dict, List
import re

CONDITIONAL_PATTERN = re.compile(r"\{if\s+not\s+([^}]+)\}|\{if\s+([^}]+)\}|\{endif\}")


def _apply_conditionals(template: str, context: Dict[str, Any]) -> str:
    """Resolve {if ...}/{if not ...} blocks in a single pass."""
    result_parts: List[str] = []
    stack: List[bool] = []
    pos = 0

    for match in CONDITIONAL_PATTERN.finditer(template):
        is_active = all(stack) if stack else True
        segment = template[pos:match.start()]
        if is_active:
            result_parts.append(segment)

        if match.group(1) is not None:
            cond_value = not bool(context.get(match.group(1)))
            stack.append(cond_value)
        elif match.group(2) is not None:
            cond_value = bool(context.get(match.group(2)))
            stack.append(cond_value)
        else:
            if stack:
                stack.pop()
        pos = match.end()

    is_active = all(stack) if stack else True
    if is_active:
        result_parts.append(template[pos:])

    return "".join(result_parts)

# =================================================================================================
# –ë–ò–ë–õ–ò–û–¢–ï–ö–ê –°–¶–ï–ù–ê–†–ò–ï–í
# =================================================================================================

TASK_15_SCENARIOS = {

    # =========================================================================
    # –¢–ï–ú–ê 1: –£–ì–õ–´
    # =========================================================================

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 1.1: –í–Ω–µ—à–Ω–∏–π —É–≥–æ–ª
    # -------------------------------------------------------------------------
    "triangle_external_angle": {
        "idea": (
            "–û—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –∫–ª—é—á–µ–≤–æ–º —Å–≤–æ–π—Å—Ç–≤–µ –≤–Ω–µ—à–Ω–µ–≥–æ —É–≥–ª–∞ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞.\n"
            "<b>–í–Ω–µ—à–Ω–∏–π —É–≥–æ–ª —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–µ–Ω —Å—É–º–º–µ –¥–≤—É—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —É–≥–ª–æ–≤, –Ω–µ —Å–º–µ–∂–Ω—ã—Ö —Å –Ω–∏–º.</b>\n"
            "–≠—Ç–æ —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π –∏ –ø—Ä—è–º–æ–π –ø—É—Ç—å –∫ –æ—Ç–≤–µ—Ç—É, –∫–æ—Ç–æ—Ä—ã–π –æ–∂–∏–¥–∞–µ—Ç—Å—è –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ.\n"
            "–ï—Å—Ç—å –∏ –≤—Ç–æ—Ä–æ–π, –±–æ–ª–µ–µ –¥–ª–∏–Ω–Ω—ã–π, –Ω–æ –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–ª—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏:\n"
            "–ù–∞–π—Ç–∏ —Ç—Ä–µ—Ç–∏–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —É–≥–æ–ª: <b>‚à†{target_vertex} = 180¬∞ - (‚à†A + ‚à†B)</b>.\n"
            "–ù–∞–π—Ç–∏ —Å–º–µ–∂–Ω—ã–π —Å –Ω–∏–º –≤–Ω–µ—à–Ω–∏–π —É–≥–æ–ª: –í–Ω–µ—à–Ω–∏–π <b>‚à†{target_vertex} = 180¬∞ - ‚à†{target_vertex}</b>."
        ),
        "steps_templates": [
            (
                "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                "–í —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ <b>{triangle_name}</b> —É–≥–æ–ª <b>A</b> —Ä–∞–≤–µ–Ω <b>{angle_a_val}¬∞</b>, "
                "–∞ —É–≥–æ–ª <b>B</b> —Ä–∞–≤–µ–Ω <b>{angle_b_val}¬∞</b>. "
                "–ù–∞–π–¥–∏—Ç–µ –≤–Ω–µ—à–Ω–∏–π —É–≥–æ–ª –ø—Ä–∏ –≤–µ—Ä—à–∏–Ω–µ <b>{target_vertex}</b>.\n"
                "–î–∞–Ω–æ: <b>‚à†A = {angle_a_val}¬∞, ‚à†B = {angle_b_val}¬∞</b>.\n"
                "–ù–∞–π—Ç–∏: –í–Ω–µ—à–Ω–∏–π —É–≥–æ–ª –ø—Ä–∏ –≤–µ—Ä—à–∏–Ω–µ <b>{target_vertex}</b>."
            ),
            (
                "<b>–®–∞–≥ 2.</b> –í–æ—Å–ø–æ–ª—å–∑—É–µ–º—Å—è –∫–ª—é—á–µ–≤—ã–º —Å–≤–æ–π—Å—Ç–≤–æ–º: –≤–Ω–µ—à–Ω–∏–π —É–≥–æ–ª —Ä–∞–≤–µ–Ω —Å—É–º–º–µ –¥–≤—É—Ö –¥—Ä—É–≥–∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —É–≥–ª–æ–≤, –Ω–µ —Å–º–µ–∂–Ω—ã—Ö —Å –Ω–∏–º.\n"
                "‚û°Ô∏è –í–Ω–µ—à–Ω–∏–π <b>‚à†{target_vertex} = ‚à†A + ‚à†B</b>"
            ),
            (
                "<b>–®–∞–≥ 3.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º—É–ª—É.\n"
                "‚û°Ô∏è –í–Ω–µ—à–Ω–∏–π <b>‚à†{target_vertex} = {angle_a_val}¬∞ + {angle_b_val}¬∞ = {res}¬∞</b>"
            ),
            (
                "<b>–®–∞–≥ 4.</b> (–°–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∞) –ü—Ä–æ–≤–µ—Ä–∏–º —Å–µ–±—è –≤—Ç–æ—Ä—ã–º —Å–ø–æ—Å–æ–±–æ–º.\n"
                "–ù–∞–π–¥–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —É–≥–æ–ª <b>{target_vertex}</b>: <b>‚à†{target_vertex} = 180¬∞ - ({angle_a_val}¬∞ + {angle_b_val}¬∞) = 180¬∞ - {res}¬∞ = {internal_c_val}¬∞</b>.\n"
                "–ù–∞–π–¥–µ–º –≤–Ω–µ—à–Ω–∏–π —É–≥–æ–ª –ø—Ä–∏ <b>{target_vertex}</b>, –∫–æ—Ç–æ—Ä—ã–π —Å–º–µ–∂–µ–Ω —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º: –í–Ω–µ—à–Ω–∏–π <b>‚à†{target_vertex} = 180¬∞ - {internal_c_val}¬∞ = {res}¬∞</b>.\n"
                "–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–≤–ø–∞–ª–∏, —Ä–µ—à–µ–Ω–∏–µ –≤–µ—Ä–Ω–æ–µ."
            )
        ],
        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",
        "tips": [
            "–ó–∞–ø–æ–º–Ω–∏ –≥–ª–∞–≤–Ω—É—é —Ñ–æ—Ä–º—É–ª—É ‚Äî —ç—Ç–æ —Å–∞–º—ã–π –∫–æ—Ä–æ—Ç–∫–∏–π –ø—É—Ç—å. –ù–∞ —ç–∫–∑–∞–º–µ–Ω–µ –≤–∞–∂–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç—å.",
            "–í—Å–µ–≥–¥–∞ –ø–æ–ª–µ–∑–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π —Å—Ö–µ–º–∞—Ç–∏—á–Ω—ã–π —Ä–∏—Å—É–Ω–æ–∫, —á—Ç–æ–±—ã –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è, –∫–∞–∫–∏–µ —É–≥–ª—ã —Å–∫–ª–∞–¥—ã–≤–∞—Ç—å.",
            "–í –æ—Ç–≤–µ—Ç –ø—Ä–æ—Å—è—Ç —á–∏—Å–ª–æ –±–µ–∑ –∑–Ω–∞–∫–∞ –≥—Ä–∞–¥—É—Å–∞. –ü—Ä–æ—Å—Ç–æ <b>{res}</b>.",
            "–°–≤–æ–π—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞."
        ]
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 1.2: –ë–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞
    # -------------------------------------------------------------------------
    "angle_bisector_find_half_angle": {
        "idea": (
            "–ó–∞–¥–∞—á–∞-–ª–æ–≤—É—à–∫–∞ –Ω–∞ –∑–Ω–∞–Ω–∏–µ —Ç–µ—Ä–º–∏–Ω–∞. –í—Å—ë —Ä–µ—à–µ–Ω–∏–µ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –æ–¥–Ω–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏:\n"
            "<b>–ë–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞ ‚Äî —ç—Ç–æ –ª—É—á, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—Ö–æ–¥–∏—Ç –∏–∑ –≤–µ—Ä—à–∏–Ω—ã —É–≥–ª–∞ –∏ –¥–µ–ª–∏—Ç –µ–≥–æ –Ω–∞ –¥–≤–∞ —Ä–∞–≤–Ω—ã—Ö —É–≥–ª–∞.</b>\n"
            "–¢–æ –µ—Å—Ç—å, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —É–≥–æ–ª, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–∑—É–µ—Ç –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞ —Å–æ —Å—Ç–æ—Ä–æ–Ω–æ–π, –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π —É–≥–æ–ª –Ω–∞ 2."
        ),
        "steps_templates": [
        (
            "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
            "–í —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ <b>{triangle_name}</b> –∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ <b>{full_angle_name} = {full_angle_val}¬∞</b>, "
            "<b>{bisector_name}</b> ‚Äî –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞. –ù–∞–π–¥–∏—Ç–µ —É–≥–æ–ª <b>{target_half_name}</b>.\n"
            "–î–∞–Ω–æ: <b>{full_angle_name} = {full_angle_val}¬∞</b>.\n"
            "–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ: <b>{bisector_name}</b> ‚Äî –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞.\n"
            "–ù–∞–π—Ç–∏: <b>‚à†{target_half_name}</b>."
        ),
        (
            "<b>–®–∞–≥ 2.</b> –í—Å–ø–æ–º–Ω–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å—ã.\n"
            "–†–∞–∑ <b>{bisector_name}</b> ‚Äî –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞ —É–≥–ª–∞ <b>{full_angle_name}</b>, –æ–Ω–∞ –¥–µ–ª–∏—Ç –µ–≥–æ –Ω–∞ –¥–≤–∞ —Ä–∞–≤–Ω—ã—Ö —É–≥–ª–∞: "
            "<b>{target_half_name}</b> –∏ <b>{second_half_name}</b>.\n"
            "‚û°Ô∏è <b>‚à†{target_half_name} = ‚à†{second_half_name} = {full_angle_name} / 2</b>"
        ),
        (
            "<b>–®–∞–≥ 3.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã–ø–æ–ª–Ω–∏–º –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ.\n"
            "‚û°Ô∏è <b>‚à†{target_half_name} = {full_angle_val}¬∞ / 2 = {res}¬∞</b>"
        )
    ],
        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",
        "tips": [
            "–ö–ª—é—á –∫ –∑–∞–¥–∞—á–µ ‚Äî —Å–ª–æ–≤–æ \"–±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞\". –ï—Å–ª–∏ —Ç—ã –∑–Ω–∞–µ—à—å, —á—Ç–æ –æ–Ω–æ –æ–∑–Ω–∞—á–∞–µ—Ç, –∑–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è –∑–∞ 5 —Å–µ–∫—É–Ω–¥.",
            "–¢—Ä–∏ –≥–ª–∞–≤–Ω—ã—Ö –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤ –ø–ª–∞–Ω–∏–º–µ—Ç—Ä–∏–∏: –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞ (–¥–µ–ª–∏—Ç —É–≥–æ–ª –ø–æ–ø–æ–ª–∞–º), –º–µ–¥–∏–∞–Ω–∞ (–¥–µ–ª–∏—Ç –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É –ø–æ–ø–æ–ª–∞–º), –≤—ã—Å–æ—Ç–∞ (–ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ). –ù–µ –ø—É—Ç–∞–π –∏—Ö!",
            "–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —á–∏—Ç–∞–π, –∫–∞–∫–æ–π –∏–∑ –¥–≤—É—Ö –ø–æ–ª–æ–≤–∏–Ω—á–∞—Ç—ã—Ö —É–≥–ª–æ–≤ –ø—Ä–æ—Å—è—Ç –Ω–∞–π—Ç–∏. –í —Å–ª—É—á–∞–µ –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å—ã –æ–Ω–∏ —Ä–∞–≤–Ω—ã, –Ω–æ –≤ –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á–∞—Ö —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∞–∂–Ω–æ."
        ]
    },

    # =========================================================================
    # –¢–ï–ú–ê 2: –¢–†–ï–£–ì–û–õ–¨–ù–ò–ö–ò –û–ë–©–ï–ì–û –í–ò–î–ê
    # =========================================================================

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 2.1: triangle_area_by_sin
    # -------------------------------------------------------------------------
    "triangle_area_by_sin": {
        "narratives": {
            "from_sin_value": {
                "idea": (
                    "–ó–∞–¥–∞—á–∞ –Ω–∞ –ø—Ä—è–º–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∏–∑ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö —Ñ–æ—Ä–º—É–ª –ø–ª–æ—â–∞–¥–∏ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞.\n"
                    "<b>–ü–ª–æ—â–∞–¥—å —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω–∞ –ø–æ–ª–æ–≤–∏–Ω–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –¥–≤—É—Ö –µ–≥–æ —Å—Ç–æ—Ä–æ–Ω –Ω–∞ —Å–∏–Ω—É—Å —É–≥–ª–∞ –º–µ–∂–¥—É –Ω–∏–º–∏.</b>\n"
                    "–§–æ—Ä–º—É–ª–∞: <b>S = 1/2 ¬∑ a ¬∑ b ¬∑ sin Œ≥</b>, –≥–¥–µ <b>a –∏ b</b> ‚Äî —Å—Ç–æ—Ä–æ–Ω—ã, –∞ <b>Œ≥ (–≥–∞–º–º–∞)</b> ‚Äî —É–≥–æ–ª, –∑–∞–∫–ª—é—á–µ–Ω–Ω—ã–π –∏–º–µ–Ω–Ω–æ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è —Å—Ç–æ—Ä–æ–Ω–∞–º–∏."
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                        "–î–∞–Ω–æ: –°—Ç–æ—Ä–æ–Ω–∞ <b>{side1_name} = {side1_val}</b>, –°—Ç–æ—Ä–æ–Ω–∞ <b>{side2_name} = {side2_val}</b>.\n"
                        "–£–≥–æ–ª –º–µ–∂–¥—É –Ω–∏–º–∏: <b>{angle_name_human}</b>.\n"
                        "–°–∏–Ω—É—Å —ç—Ç–æ–≥–æ —É–≥–ª–∞: <b>sin{angle_name_human} = {sin_val}</b>.\n"
                        "–ù–∞–π—Ç–∏: –ü–ª–æ—â–∞–¥—å <b>S</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2</b>. –ó–∞–ø–∏—à–µ–º —Ñ–æ—Ä–º—É–ª—É –ø–ª–æ—â–∞–¥–∏ —á–µ—Ä–µ–∑ —Å–∏–Ω—É—Å.\n"
                        "‚û°Ô∏è <b>S = 1/2 ¬∑ {side1_name} ¬∑ {side2_name} ¬∑ sin‚à†{angle_name}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 3</b>. –ü–æ–¥—Å—Ç–∞–≤–∏–º –≤ —Ñ–æ—Ä–º—É–ª—É –≤—Å–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –Ω–∞–º –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤—ã—á–∏—Å–ª–∏–º.\n"
                        "‚û°Ô∏è <b>S = 1/2 ¬∑ {side1_val} ¬∑ {side2_val} ¬∑ {sin_val}</b>\n"
                        "{detailed_computation_line}"
                    )
                ],
                # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: Tips –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ, –Ω–æ –∑–¥–µ—Å—å –º—ã –æ–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–æ–π –Ω–∞–±–æ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
                "tips_key": "default"
            },
            "from_degrees": {
                "idea": (
                    "–ó–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è –ø–æ —Ç–æ–π –∂–µ –∫–ª—é—á–µ–≤–æ–π —Ñ–æ—Ä–º—É–ª–µ (–ø–ª–æ—â–∞–¥—å —á–µ—Ä–µ–∑ —Å–∏–Ω—É—Å), –Ω–æ —Å –æ–¥–Ω–∏–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –¥–µ–π—Å—Ç–≤–∏–µ–º –≤ –Ω–∞—á–∞–ª–µ.\n"
                    "<b>–ü–ª–æ—â–∞–¥—å —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω–∞ –ø–æ–ª–æ–≤–∏–Ω–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –¥–≤—É—Ö –µ–≥–æ —Å—Ç–æ—Ä–æ–Ω –Ω–∞ —Å–∏–Ω—É—Å —É–≥–ª–∞ –º–µ–∂–¥—É –Ω–∏–º–∏.</b>\n"
                    "–ö–ª—é—á–µ–≤–æ–µ –æ—Ç–ª–∏—á–∏–µ —ç—Ç–æ–≥–æ —Ç–∏–ø–∞ –∑–∞–¥–∞—á ‚Äî —É–≥–æ–ª –¥–∞–Ω –≤ –≥—Ä–∞–¥—É—Å–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, <b>30¬∞, 45¬∞, 120¬∞</b>). –ü–æ—ç—Ç–æ–º—É, –ø–µ—Ä–µ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º—É–ª—ã, –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —à–∞–≥: <b>–Ω–∞–π—Ç–∏ —Å–∏–Ω—É—Å —ç—Ç–æ–≥–æ —É–≥–ª–∞</b>, –≤—Å–ø–æ–º–Ω–∏–≤ –µ–≥–æ —Ç–∞–±–ª–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ."
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                        "–î–∞–Ω–æ: –°—Ç–æ—Ä–æ–Ω–∞ <b>{side1_name} = {side1_val}</b>, –°—Ç–æ—Ä–æ–Ω–∞ <b>{side2_name} = {side2_val}</b>.\n"
                        "–£–≥–æ–ª –º–µ–∂–¥—É –Ω–∏–º–∏: <b>{angle_name_human} = {angle_val}¬∞</b>.\n"
                        "–ù–∞–π—Ç–∏: –ü–ª–æ—â–∞–¥—å <b>S</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2</b>. –ó–∞–ø–∏—à–µ–º –æ—Å–Ω–æ–≤–Ω—É—é —Ñ–æ—Ä–º—É–ª—É –ø–ª–æ—â–∞–¥–∏ —á–µ—Ä–µ–∑ —Å–∏–Ω—É—Å.\n"
                        "‚û°Ô∏è <b>S = 1/2 ¬∑ {side1_name} ¬∑ {side2_name} ¬∑ sin‚à†{angle_name}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 3</b>. –ù–∞–π–¥–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏–Ω—É—Å–∞ –¥–ª—è –Ω–∞—à–µ–≥–æ —É–≥–ª–∞.\n"
                        "–£–≥–æ–ª <b>{angle_name_human}</b> —Ä–∞–≤–µ–Ω <b>{angle_val}¬∞</b>. –≠—Ç–æ —Ç–∞–±–ª–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –Ω–∞–∏–∑—É—Å—Ç—å.\n"
                        "‚û°Ô∏è <b>sin {angle_val}¬∞ = {sin_val_str}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 4</b>. –ü–æ–¥—Å—Ç–∞–≤–∏–º –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ —Ñ–æ—Ä–º—É–ª—É –∏ –≤—ã—á–∏—Å–ª–∏–º.\n"
                        "‚û°Ô∏è <b>S = 1/2 ¬∑ {side1_val} ¬∑ {side2_val} ¬∑ {sin_val_str}</b>\n"
                        "{detailed_computation_line}"
                    )
                ],
                "tips_key": "from_degrees"
            }
        },
        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",
        # –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ë–ª–æ–∫ tips —Ç–µ–ø–µ—Ä—å –∑–¥–µ—Å—å, –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ
        "tips": {
            "default": [
                "–ì–ª–∞–≤–Ω–æ–µ ‚Äî —É–≥–æ–ª –ú–ï–ñ–î–£ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏! –£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ –∑–∞–¥–∞—á–µ –¥–∞–Ω —Å–∏–Ω—É—Å –∏–º–µ–Ω–Ω–æ —Ç–æ–≥–æ —É–≥–ª–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –º–µ–∂–¥—É –¥–≤—É–º—è –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏.",
                "–ù–µ –∑–∞–±—É–¥—å –ø—Ä–æ <b>1/2</b>! –≠—Ç–æ —Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–π —Ñ–æ—Ä–º—É–ª—ã.",
                "–°–∏–Ω—É—Å ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —á–∏—Å–ª–æ (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç), –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ —É–º–Ω–æ–∂–∏—Ç—å. –ù–µ –ø—É–≥–∞–π—Å—è –¥—Ä–æ–±–µ–π.",
                "–ò–Ω–æ–≥–¥–∞ –≤ –∑–∞–¥–∞—á–µ –±—É–¥–µ—Ç –¥–∞–Ω —Å–∞–º —É–≥–æ–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, <b>30¬∞, 45¬∞, 60¬∞</b>). –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω—É–∂–Ω–æ –≤—Å–ø–æ–º–Ω–∏—Ç—å —Ç–∞–±–ª–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–∏–Ω—É—Å–æ–≤: <b>sin 30¬∞ = 1/2, sin 45¬∞ = ‚àö2/2, sin 60¬∞ = ‚àö3/2</b>."
            ],
            "from_degrees": [
                "–ü–µ—Ä–≤—ã–π —à–∞–≥ ‚Äî –≤—Å–ø–æ–º–Ω–∏—Ç—å —Å–∏–Ω—É—Å! –ï—Å–ª–∏ —É–≥–æ–ª \"–∫—Ä–∞—Å–∏–≤—ã–π\" <b>(30¬∞, 45¬∞, 60¬∞ –∏ –∏—Ö \"—Å–æ—Å–µ–¥–∏\" 150¬∞, 135¬∞, 120¬∞)</b>, –µ–≥–æ —Å–∏–Ω—É—Å –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –Ω–∞–∏–∑—É—Å—Ç—å. –≠—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç –¥—Ä–∞–≥–æ—Ü–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ.",
                "–î–ª—è —Ç—É–ø—ã—Ö —É–≥–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–æ—Ä–º—É–ª–∞ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è: <b>sin(180¬∞ - Œ±) = sin(Œ±)</b>. –ù–∞–ø—Ä–∏–º–µ—Ä, <b>sin(150¬∞) = sin(180¬∞ - 150¬∞) = sin(30¬∞) = 1/2</b>.",
                "–ù–µ –∑–∞–±—É–¥—å –ø—Ä–æ <b>1/2</b>! –≠—Ç–æ —Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ–π —Ñ–æ—Ä–º—É–ª—ã.",
                "–ì–ª–∞–≤–Ω–æ–µ ‚Äî —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —É–≥–æ–ª –¥–∞–Ω –∏–º–µ–Ω–Ω–æ –º–µ–∂–¥—É –¥–≤—É–º—è –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏."
            ]
        }
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 2.2: triangle_area_by_dividing_point
    # -------------------------------------------------------------------------
    "triangle_area_by_dividing_point": {
        "narratives": {
            "find_small_from_big": {
                "idea": (
                    "–í—Å—è –∑–∞–¥–∞—á–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Å–≤–æ–π—Å—Ç–≤–µ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ —Å –æ–±—â–µ–π –≤—ã—Å–æ—Ç–æ–π.\n"
                    "–¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ –æ–¥–Ω–æ–π –≤—ã—Å–æ—Ç–µ –∏–∑ –≤–µ—Ä—à–∏–Ω—ã <b>B</b>, –∏–º–µ—é—Ç –ø–ª–æ—â–∞–¥–∏, "
                    "–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ <b>–æ—Å–Ω–æ–≤–∞–Ω–∏—è–º —ç—Ç–∏—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤</b>.\n"
                    "–ü–æ—ç—Ç–æ–º—É –∏—Å–∫–æ–º–∞—è –ø–ª–æ—â–∞–¥—å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–∞–∫ –¥–æ–ª—è –æ—Ç –ø–ª–æ—â–∞–¥–∏ –≤—Å–µ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ <b>ABC</b> ‚Äî "
                    "–≤ —Ç–æ–π –∂–µ –¥–æ–ª–µ, –≤ –∫–∞–∫–æ–π –Ω—É–∂–Ω—ã–π –æ—Ç—Ä–µ–∑–æ–∫ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Ç –≤—Å–µ–π —Å—Ç–æ—Ä–æ–Ω—ã <b>AC</b>.\n"
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ:\n"
                        "–î–∞–Ω–æ: S(ABC) = <b>{s_abc_val}</b>, AD = <b>{ad_val}</b>, DC = <b>{dc_val}</b>.\n"
                        "–ù–∞–π—Ç–∏: <b>{target_area_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –ù–∞–π–¥–µ–º –ø–æ–ª–Ω—É—é –¥–ª–∏–Ω—É –æ—Å–Ω–æ–≤–∞–Ω–∏—è AC.\n"
                        "‚û°Ô∏è <b>AC = AD + DC = {ad_val} + {dc_val} = {base_total_val}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 3.</b> –ù–∞–π–¥–µ–º, –∫–∞–∫—É—é –¥–æ–ª—é –æ—Ç –≤—Å–µ–≥–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—è AC —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏–µ <b>{target_base_name}</b>.\n"
                        "‚û°Ô∏è –î–æ–ª—è = {target_base_name} / AC = <b>{target_base_share_str}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 4.</b> –ü–ª–æ—â–∞–¥—å <b>{target_area_name}</b> —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–∞–∫—É—é –∂–µ –¥–æ–ª—é –æ—Ç –æ–±—â–µ–π –ø–ª–æ—â–∞–¥–∏.\n"
                        "‚û°Ô∏è <b>{target_area_name} = S(ABC) ¬∑ ({target_base_share_str}) = {s_abc_val} ¬∑ ({target_base_share_str}) = {res}</b>"
                    ),
                ],
                "tips_key": "find_small_from_big"
            },

            # ‚úÖ –ù–û–í–´–ô NARRATIVE: compare_small_triangles (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ)
            "compare_small_triangles": {
                "idea": (
                    "–ó–¥–µ—Å—å –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ <b>–±–æ–ª—å—à–∏–π</b> –∏–ª–∏ <b>–º–µ–Ω—å—à–∏–π</b> –∏–∑ –¥–≤—É—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ <b>ABD</b> –∏ <b>BCD</b>.\n"
                    "–£ –Ω–∏—Ö <b>–æ–±—â–∞—è –≤—ã—Å–æ—Ç–∞</b>, –æ–ø—É—â–µ–Ω–Ω–∞—è –∏–∑ –≤–µ—Ä—à–∏–Ω—ã <b>B</b> –Ω–∞ –ø—Ä—è–º—É—é <b>AC</b>, –ø–æ—ç—Ç–æ–º—É –∏—Ö –ø–ª–æ—â–∞–¥–∏ "
                    "–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã –æ—Å–Ω–æ–≤–∞–Ω–∏—è–º <b>AD</b> –∏ <b>DC</b>.\n"
                    "–°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º, –∫–∞–∫–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –±–æ–ª—å—à–µ (–∏–ª–∏ –º–µ–Ω—å—à–µ), –∏ —Ç–µ–º —Å–∞–º—ã–º –ø–æ–Ω–∏–º–∞–µ–º, –∫–∞–∫–æ–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ "
                    "–±–æ–ª—å—à–µ (–∏–ª–∏ –º–µ–Ω—å—à–µ). –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–∞—Ö–æ–¥–∏–º –¥–æ–ª—é –æ—Ç –ø–ª–æ—â–∞–¥–∏ <b>S(ABC)</b> –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é <b>AD:DC</b>.\n"
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ:\n"
                        "–î–∞–Ω–æ: S(ABC) = <b>{s_abc_val}</b>. –û—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫–∞–∫ <b>AD : DC = {ad_val} : {dc_val}</b>.\n"
                        "–ù–∞–π—Ç–∏: <b>{target_area_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –û–ø—Ä–µ–¥–µ–ª–∏–º, –∫–∞–∫–æ–º—É –æ—Å–Ω–æ–≤–∞–Ω–∏—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∏—Å–∫–æ–º—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫.\n"
                        "<b>–ë–æ–ª—å—à–µ–º—É –æ—Å–Ω–æ–≤–∞–Ω–∏—é</b> —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <b>–±–æ–ª—å—à–∏–π</b> —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫, –º–µ–Ω—å—à–µ–º—É ‚Äî –º–µ–Ω—å—à–∏–π.\n"
                    ),
                    (
                        "<b>–®–∞–≥ 3.</b> –ù–∞–π–¥–µ–º –¥–æ–ª—é –∏—Å–∫–æ–º–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –æ—Ç –ø–ª–æ—â–∞–¥–∏ –≤—Å–µ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞.\n"
                        "–û—Å–Ω–æ–≤–∞–Ω–∏–µ <b>AC</b> —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ <b>{total_parts}</b> —á–∞—Å—Ç–µ–π (<b>{ad_val} + {dc_val}</b>).\n"
                        "–ò—Å–∫–æ–º—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <b>{target_base_parts}</b> —á–∞—Å—Ç—è–º.\n"
                        "‚û°Ô∏è –î–æ–ª—è = <b>{target_base_parts}/{total_parts}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 4.</b> –ù–∞–π–¥–µ–º –∏—Å–∫–æ–º—É—é –ø–ª–æ—â–∞–¥—å –∫–∞–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –¥–æ–ª—é –æ—Ç <b>S(ABC)</b>.\n"
                        "‚û°Ô∏è <b>{target_area_name} = S(ABC) ¬∑ ({target_base_parts}/{total_parts}) = {s_abc_val} ¬∑ ({target_base_parts}/{total_parts}) = {res}</b>"
                    ),
                ],
                "tips_key": "compare_small_triangles"
            },

            "find_from_small": {
                "idea": (
                    "–í—Å—è –∑–∞–¥–∞—á–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Å–≤–æ–π—Å—Ç–≤–µ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ —Å –æ–±—â–µ–π –≤—ã—Å–æ—Ç–æ–π.\n"
                    "–¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ –æ–¥–Ω–æ–π –≤—ã—Å–æ—Ç–µ –∏–∑ –≤–µ—Ä—à–∏–Ω—ã <b>B</b>, –∏–º–µ—é—Ç –ø–ª–æ—â–∞–¥–∏, "
                    "–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ <b>–æ—Å–Ω–æ–≤–∞–Ω–∏—è–º —ç—Ç–∏—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤</b>.\n"
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ:\n"
                        "–î–∞–Ω–æ: <b>{known_area_name} = {known_area_val}</b>. –û—Å–Ω–æ–≤–∞–Ω–∏—è –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫–∞–∫ <b>AD : DC = {ad_val} : {dc_val}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –ù–∞–π–¥–µ–º, —Å–∫–æ–ª—å–∫–æ –ø–ª–æ—â–∞–¥–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –æ–¥–Ω—É \"—á–∞—Å—Ç—å\" –æ—Ç–Ω–æ—à–µ–Ω–∏—è.\n"
                        "–ü–ª–æ—â–∞–¥—å <b>{known_area_name}</b> —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <b>{known_base_parts}</b> —á–∞—Å—Ç—è–º.\n"
                        "‚û°Ô∏è <b>1 —á–∞—Å—Ç—å = {known_area_val} / {known_base_parts} = {one_part_val}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 3.</b> –ù–∞–π–¥–µ–º –∏—Å–∫–æ–º—É—é –ø–ª–æ—â–∞–¥—å.\n"
                        "{if is_find_big}"
                        "–ü–ª–æ—â–∞–¥—å <b>S(ABC)</b> —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <b>{total_parts}</b> —á–∞—Å—Ç—è–º (<b>{ad_val} + {dc_val}</b>).\n"
                        "‚û°Ô∏è <b>S(ABC) = (1 —á–∞—Å—Ç—å) ¬∑ {total_parts} = {one_part_val} ¬∑ {total_parts} = {total_area_val}</b>"
                        "{endif}"
                        "{if not is_find_big}"
                        "–ü–ª–æ—â–∞–¥—å <b>{target_area_name}</b> —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <b>{target_base_parts}</b> —á–∞—Å—Ç—è–º.\n"
                        "‚û°Ô∏è <b>{target_area_name} = (1 —á–∞—Å—Ç—å) ¬∑ {target_base_parts} = {one_part_val} ¬∑ {target_base_parts} = {other_small_area_val}</b>\n"
                        "{endif}"
                    )
                ],
                "tips_key": "default"
            }
        },

        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": {
            "find_small_from_big": [
                "–ó–æ–ª–æ—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –í–æ —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –æ—Å–Ω–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –±–æ–ª—å—à–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–æ–≥–æ (–ø—Ä–∏ –æ–±—â–µ–π –≤—ã—Å–æ—Ç–µ), –≤–æ —Å—Ç–æ–ª—å–∫–æ –∂–µ —Ä–∞–∑ –∏ –µ–≥–æ –ø–ª–æ—â–∞–¥—å –±–æ–ª—å—à–µ.",
                "–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ ‚Äî —ç—Ç–æ –∫—É—Å–æ–∫ –ø–∏—Ä–æ–≥–∞. –†–∞–∑—Ä–µ–∑ <b>BD</b> –¥–µ–ª–∏—Ç –µ–≥–æ –Ω–∞ –¥–≤–∞ –∫—É—Å–∫–∞. –ß–µ–º —à–∏—Ä–µ –æ—Å–Ω–æ–≤–∞–Ω–∏–µ –∫—É—Å–∫–∞ (<b>AD</b> –∏–ª–∏ <b>DC</b>), —Ç–µ–º –±–æ–ª—å—à–µ –µ–≥–æ –ø–ª–æ—â–∞–¥—å.",
                "–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —á–∏—Ç–∞–π, –ø–ª–æ—â–∞–¥—å –∫–∞–∫–æ–≥–æ –∏–∑ –º–µ–Ω—å—à–∏—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ (<b>ABD</b> –∏–ª–∏ <b>BCD</b>).",
                "–ï—Å–ª–∏ –≤ —É—Å–ª–æ–≤–∏–∏ –¥–∞–Ω–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, <b>1:4</b>), —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—Å—ë –æ—Å–Ω–æ–≤–∞–Ω–∏–µ –º–æ–∂–Ω–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ <b>1 + 4 = 5</b> —Ä–∞–≤–Ω—ã—Ö —á–∞—Å—Ç–µ–π. –¢–æ–≥–¥–∞ –æ–¥–∏–Ω —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –∑–∞–π–º–µ—Ç <b>1/5</b> –ø–ª–æ—â–∞–¥–∏, –∞ –≤—Ç–æ—Ä–æ–π ‚Äî <b>4/5</b>."
            ],
            "compare_small_triangles": [
                "–í –∑–∞–¥–∞—á–∞—Ö —Å–æ —Å–ª–æ–≤–∞–º–∏ <b>¬´–±–æ–ª—å—à–∏–π¬ª</b> –∏–ª–∏ <b>¬´–º–µ–Ω—å—à–∏–π¬ª</b> —Å–Ω–∞—á–∞–ª–∞ —Ä–µ—à–∏ –ª–æ–≥–∏—á–µ—Å–∫—É—é —á–∞—Å—Ç—å: –∫–∞–∫–æ–π –æ—Ç—Ä–µ–∑–æ–∫ –±–æ–ª—å—à–µ ‚Äî <b>AD</b> –∏–ª–∏ <b>DC</b>. –≠—Ç–æ —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–æ–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –±–æ–ª—å—à–µ.",
                "–ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —É–¥–æ–±–Ω–µ–µ –≤—Å–µ–≥–æ —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ ¬´—á–∞—Å—Ç–∏¬ª: —Å–ª–æ–∂–∏—Ç—å —á–∏—Å–ª–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏—è <b>{ad_val} + {dc_val}</b> –∏ –≤–∑—è—Ç—å –Ω—É–∂–Ω—É—é –¥–æ–ª—é.",
                "–ù–µ –ø—É—Ç–∞–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ: <b>S(ABD)</b> ‚Üî <b>AD</b>, –∞ <b>S(BCD)</b> ‚Üî <b>DC</b>."
            ],
            "default": [
                "\"–ú–µ—Ç–æ–¥ –ø—Ä–æ–ø–æ—Ä—Ü–∏–π\" –∏–ª–∏ \"–º–µ—Ç–æ–¥ —á–∞—Å—Ç–µ–π\" ‚Äî —Å–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–ª—è —Ç–∞–∫–∏—Ö –∑–∞–¥–∞—á.",
                "–û–±—â–∞—è –ø–ª–æ—â–∞–¥—å ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å—É–º–º–∞ –¥–≤—É—Ö –º–∞–ª–µ–Ω—å–∫–∏—Ö: <b>S(ABC) = S(ABD) + S(BCD)</b>.",
                "–ì–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è! –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è–π, –∫–∞–∫–∞—è –ø–ª–æ—â–∞–¥—å –∫–∞–∫–æ–º—É –æ—Å–Ω–æ–≤–∞–Ω–∏—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç: <b>S(ABD)</b> —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <b>AD</b>, –∞ <b>S(BCD)</b> ‚Äî <b>DC</b>."
            ]
        }
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 2.3: triangle_area_by_parallel_line
    # -------------------------------------------------------------------------
    "triangle_area_by_parallel_line": {
        "narratives": {

            # üü° –§–û–†–ú–ê: area_by_similarity
            "area_by_similarity": {
                "idea": (
                    "–í –æ—Å–Ω–æ–≤–µ –ª–µ–∂–∏—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ –ø–æ–¥–æ–±–Ω—ã—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤. "
                    "–ü—Ä—è–º–∞—è, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–µ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ (<b>MN ‚à• AC</b>), "
                    "–æ—Ç—Å–µ–∫–∞–µ—Ç –æ—Ç –Ω–µ–≥–æ –ø–æ–¥–æ–±–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ (<b>ŒîMBN ~ ŒîABC</b>).\n"
                    "–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∏—Ö –ø–ª–æ—â–∞–¥–µ–π —Ä–∞–≤–Ω–æ <b>–ö–í–ê–î–†–ê–¢–£</b> –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø–æ–¥–æ–±–∏—è <b>k¬≤</b>:\n"
                    "<b>S(–º–∞–ª–µ–Ω—å–∫–æ–≥–æ) / S(–±–æ–ª—å—à–æ–≥–æ) = k¬≤</b>"
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n"
                        "{if known_area_val}–î–∞–Ω–æ: <b>{known_area_name} = {known_area_val}</b>{endif}"
                        "{if ac_val}, <b>AC = {ac_val}</b>{endif}"
                        "{if mn_val}, <b>MN = {mn_val}</b>{endif}. "
                        "<b>MN ‚à• AC</b>.\n"
                        "–ù–∞–π—Ç–∏: <b>{target_area_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –£—Å—Ç–∞–Ω–æ–≤–∏–º —Ñ–∞–∫—Ç –ø–æ–¥–æ–±–∏—è.\n"
                        "–ü–æ—Å–∫–æ–ª—å–∫—É <b>MN ‚à• AC</b>, —Ç–æ "
                        "<b>ŒîMBN ~ ŒîABC</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 3.</b> –ù–∞–π–¥—ë–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è <b>k</b>.\n"
                        "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç k ‚Äî —ç—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ö–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω (–º–∞–ª–µ–Ω—å–∫–æ–π –∫ –±–æ–ª—å—à–æ–π).\n"
                        # –¢–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏ –∏—Å—Ö–æ–¥–Ω—É—é –¥—Ä–æ–±—å, –∏ —Å–æ–∫—Ä–∞—â–µ–Ω–Ω—É—é
                        "‚û°Ô∏è <b>k = MN / AC = {mn_val} / {ac_val} = {k_val}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 4.</b> –ù–∞–π–¥—ë–º –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–ª–æ—â–∞–¥–µ–π, –≤–æ–∑–≤–µ–¥—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è –≤ –∫–≤–∞–¥—Ä–∞—Ç.\n"
                        "‚û°Ô∏è <b>S(MBN) / S(ABC) = k¬≤</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 5.</b> –í—ã—Ä–∞–∑–∏–º –∏—Å–∫–æ–º—É—é –ø–ª–æ—â–∞–¥—å.\n"
                        "‚û°Ô∏è <b>{target_area_name} = {known_area_name} ¬∑ k¬≤</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 6.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤—ã—á–∏—Å–ª–∏–º.\n"
                        "‚û°Ô∏è <b>{target_area_name} = {known_area_val} ¬∑ {k_squared_str} = {res}</b>"
                    ),
                ],
                "tips_key": "area"
            },

            # üü° –§–û–†–ú–ê: segments_by_similarity
            "segments_by_similarity": {
                "idea": (
                    "–ó–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–æ–¥–æ–±–∏–µ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤.\n"
                    "–¢–∞–∫ –∫–∞–∫ <b>MN ‚à• AC</b>, —Ç–æ\n"
                    "<b>‚à†BMN = ‚à†BAC</b> ‚Äî —ç—Ç–æ –Ω–∞–∫—Ä–µ—Å—Ç –ª–µ–∂–∞—â–∏–µ —É–≥–ª—ã –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä—è–º—ã—Ö.\n"
                    "–ö—Ä–æ–º–µ —Ç–æ–≥–æ, —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏ <b>MBN</b> –∏ <b>ABC</b> –∏–º–µ—é—Ç –æ–±—â–∏–π —É–≥–æ–ª –ø—Ä–∏ –≤–µ—Ä—à–∏–Ω–µ <b>B</b>:\n"
                    "<b>‚à†MBN = ‚à†ABC</b>.\n"
                    "–†–∞–∑ —É –¥–≤—É—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ —Ä–∞–≤–Ω—ã –¥–≤–∞ —É–≥–ª–∞, –∑–Ω–∞—á–∏—Ç —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏ "
                    "<b>MBN</b> –∏ <b>ABC</b> –ø–æ–¥–æ–±–Ω—ã.\n"
                    "–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∏—Ö —Å—Ö–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –æ—Ç–Ω–æ—Å—è—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ."
                ),

                "steps_templates": {

                    # üü° –ü–û–î–§–û–†–ú–ê A ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–ª–æ–π —Å—Ç–æ—Ä–æ–Ω—ã (–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏)
                    "restore_whole_side": [
                        (
                            "<b>–®–∞–≥ 1.</b> –ó–∞–ø–∏—à–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —É—Å–ª–æ–≤–∏—è.\n"
                            "–î–∞–Ω–æ:"
                            "{if ac_val} <b>AC = {ac_val}</b>{endif}"
                            "{if mn_val} <b>MN = {mn_val}</b>{endif}"
                            "{if ab_val} <b>AB = {ab_val}</b>{endif}"
                            "{if bc_val} <b>BC = {bc_val}</b>{endif}"
                            "{if am_val} <b>AM = {am_val}</b>{endif}"
                            "{if bm_val} <b>BM = {bm_val}</b>{endif}"
                            "{if bn_val} <b>BN = {bn_val}</b>{endif}"
                            "{if nc_val} <b>NC = {nc_val}</b>{endif}"
                            "{if cn_val} <b>CN = {cn_val}</b>{endif}.\n"
                            "–ù–∞–π—Ç–∏: <b>{to_find_name}</b>."
                        ),
                        (
                            "<b>–®–∞–≥ 2.</b> –ù–∞–π–¥—ë–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è <b>k</b>.\n"
                            "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è ‚Äî —ç—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ö–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω (—Å—Ç–æ—Ä–æ–Ω—ã –º–∞–ª–µ–Ω—å–∫–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –∫ —Å—Ç–æ—Ä–æ–Ω–µ –±–æ–ª—å—à–æ–≥–æ).\n"
                            "‚û°Ô∏è <b>k = MN / AC = {k_num}/{k_den} = {k_val}</b>"
                        ),
                        (
                            "<b>–®–∞–≥ 3.</b> –ó–∞–ø–∏—à–µ–º –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–ª—è –¥—Ä—É–≥–æ–π –ø–∞—Ä—ã —Å—Ö–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω.\n"
                            "–°—Ç–æ—Ä–æ–Ω–∞ <b>{restore_unknown_part_name}</b> –º–∞–ª–µ–Ω—å–∫–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Å—Ç–æ—Ä–æ–Ω–µ "
                            "<b>{restore_whole_name}</b> –±–æ–ª—å—à–æ–≥–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ <b>MN</b> –∫ <b>AC</b>.\n"
                            "‚û°Ô∏è <b>{restore_unknown_part_name} / {restore_whole_name} = k = {k_val}</b>\n"
                            "–£–º–Ω–æ–∂–∏–º –æ–±–µ —á–∞—Å—Ç–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–∞ –Ω–∞ <b>{restore_whole_name}</b>:\n"
                            "‚û°Ô∏è <b>{restore_unknown_part_name} = {k_val} ¬∑ {restore_whole_name}</b>"
                        ),
                        (
                            "<b>–®–∞–≥ 4.</b> –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–º –¥–ª–∏–Ω—É —Å—Ç–æ—Ä–æ–Ω—ã <b>{restore_whole_name}</b>.\n"
                            "–ü–æ —É—Å–ª–æ–≤–∏—é —Ç–æ—á–∫–∞ <b>{restore_point_name}</b> –ª–µ–∂–∏—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ <b>{restore_whole_name}</b>, –ø–æ—ç—Ç–æ–º—É –≤—Å—è —Å—Ç–æ—Ä–æ–Ω–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –¥–≤—É—Ö –æ—Ç—Ä–µ–∑–∫–æ–≤:\n"
                            "‚û°Ô∏è <b>{restore_whole_name} = {restore_part_name} + {restore_unknown_part_name}</b>.\n"
                            "–ü–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ <b>{restore_part_name}</b> –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è <b>{restore_unknown_part_name}</b> –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞:\n"
                            "‚û°Ô∏è <b>{restore_whole_name} = {restore_part_val} + {k_val} ¬∑ {restore_whole_name}</b>."
                        ),
                        (
                            "<b>–®–∞–≥ 5.</b> –†–µ—à–∏–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ –∏ –Ω–∞–π–¥—ë–º <b>{restore_whole_name}</b>.\n"
                            "‚û°Ô∏è <b>{restore_whole_name} ‚àí {k_val} ¬∑ {restore_whole_name} = {restore_part_val}</b>\n"
                            "‚û°Ô∏è <b>{one_minus_k} ¬∑ {restore_whole_name} = {restore_part_val}</b>\n"
                            "‚û°Ô∏è <b>{restore_whole_name} = {final_value}</b>"
                        ),
                    ],

                    # üü° –ü–û–î–§–û–†–ú–ê B ‚Äî –ø—Ä—è–º–∞—è –ø—Ä–æ–ø–æ—Ä—Ü–∏—è (–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏)
                    "direct_by_k": [
                        (
                            "<b>–®–∞–≥ 1</b>. –ó–∞–ø–∏—à–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —É—Å–ª–æ–≤–∏—è.\n"
                            "–î–∞–Ω–æ:"
                            "{if ac_val} <b>AC = {ac_val}</b>{endif}"
                            "{if mn_val} <b>MN = {mn_val}</b>{endif}"
                            "{if ab_val} <b>AB = {ab_val}</b>{endif}"
                            "{if bc_val} <b>BC = {bc_val}</b>{endif}"
                            "{if am_val} <b>AM = {am_val}</b>{endif}"
                            "{if bm_val} <b>BM = {bm_val}</b>{endif}"
                            "{if bn_val} <b>BN = {bn_val}</b>{endif}"
                            "{if nc_val} <b>NC = {nc_val}</b>{endif}"
                            "{if cn_val} <b>CN = {cn_val}</b>{endif}.\n"
                            "–ù–∞–π—Ç–∏: <b>{to_find_name}</b>."
                        ),
                        (
                            "<b>–®–∞–≥ 2</b>. –ù–∞–π–¥—ë–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è <b>k</b>.\n"
                            "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è ‚Äî —ç—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ö–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω (—Å—Ç–æ—Ä–æ–Ω—ã –º–∞–ª–µ–Ω—å–∫–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –∫ —Å—Ç–æ—Ä–æ–Ω–µ –±–æ–ª—å—à–æ–≥–æ).\n"
                            "‚û°Ô∏è <b>k = MN / AC = {k_num}/{k_den} = {k_val}</b>"
                        ),
                        (
                            "<b>–®–∞–≥ 3</b>. –ù–∞–π–¥—ë–º –∏—Å–∫–æ–º—ã–π –æ—Ç—Ä–µ–∑–æ–∫.\n"
                            "–°—Ç–æ—Ä–æ–Ω–∞ <b>{direct_small_side}</b> —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–æ—Ä–æ–Ω–µ <b>{direct_big_side}</b>.\n"
                            "{if direct_big_side_val}"
                                "‚û°Ô∏è <b>{direct_small_side} / {direct_big_side} = k</b>\n"
                                "‚û°Ô∏è <b>{direct_small_side} = k ¬∑ {direct_big_side} = {k_val} ¬∑ {direct_big_side_val} = {final_value}</b>"
                            "{endif}"
                            "{if not direct_big_side_val}"
                                "‚û°Ô∏è <b>{direct_small_side} = k ¬∑ {direct_big_side}</b>\n"
                                "–û—Ç—Å—é–¥–∞ –≤—ã—Ä–∞–∑–∏–º –±–æ–ª—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É:\n"
                                "‚û°Ô∏è <b>{direct_big_side} = {direct_small_side} / k = {direct_small_side_val} : {k_val} = {final_value}</b>"
                            "{endif}"
                        ),
                    ],

                    # üü° –ü–û–î–§–û–†–ú–ê C ‚Äî –ø–æ–∏—Å–∫ –≤–µ—Ä—Ö–Ω–µ–π —á–∞—Å—Ç–∏ (–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–ª—é—á–∏)
                    "find_top_part": [
                        (
                            "<b>–®–∞–≥ 1</b>. –ó–∞–ø–∏—à–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —É—Å–ª–æ–≤–∏—è.\n"
                            "–î–∞–Ω–æ:"
                            "{if ac_val} <b>AC = {ac_val}</b>{endif}"
                            "{if mn_val} <b>MN = {mn_val}</b>{endif}"
                            "{if ab_val} <b>AB = {ab_val}</b>{endif}"
                            "{if bc_val} <b>BC = {bc_val}</b>{endif}"
                            "{if am_val} <b>AM = {am_val}</b>{endif}"
                            "{if bm_val} <b>BM = {bm_val}</b>{endif}"
                            "{if bn_val} <b>BN = {bn_val}</b>{endif}"
                            "{if nc_val} <b>NC = {nc_val}</b>{endif}"
                            "{if cn_val} <b>CN = {cn_val}</b>{endif}.\n"
                            "–ù–∞–π—Ç–∏: <b>{to_find_name}</b>."
                        ),
                        (
                            "<b>–®–∞–≥ 2</b>. –ù–∞–π–¥—ë–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è <b>k</b>.\n"
                            "‚û°Ô∏è <b>k = MN / AC = {k_num}/{k_den} = {k_val}</b>"
                        ),
                        (
                            "<b>–®–∞–≥ 3</b>. –ù–∞–π–¥–µ–º —Å—Ç–æ—Ä–æ–Ω—É <b>{find_top_bottom_part_name}</b> –º–∞–ª–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞.\n"
                            "–¢–∞–∫ –∫–∞–∫ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏ –ø–æ–¥–æ–±–Ω—ã, –µ—ë —Å—Ç–æ—Ä–æ–Ω–∞ <b>{find_top_bottom_part_name}</b> –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Å—Ç–æ—Ä–æ–Ω–µ <b>{find_top_whole_name}</b> –±–æ–ª—å—à–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è:\n"
                            "‚û°Ô∏è <b>{find_top_bottom_part_name} / {find_top_whole_name} = k</b>\n"
                            "‚û°Ô∏è <b>{find_top_bottom_part_name} = k ¬∑ {find_top_whole_name} = {k_val} ¬∑ {find_top_whole_val} = {find_top_bottom_part_val}</b>"
                        ),
                        (
                            "<b>–®–∞–≥ 4</b>. –ù–∞–π–¥—ë–º –∏—Å–∫–æ–º—ã–π –æ—Ç—Ä–µ–∑–æ–∫ <b>{to_find_name}</b>.\n"
                            "–¢–∞–∫ –∫–∞–∫ <b>{to_find_name} = {find_top_whole_name} - {find_top_bottom_part_name}</b>:\n"
                            "‚û°Ô∏è <b>{to_find_name} = {find_top_whole_val} - {find_top_bottom_part_val} = {final_value}</b>"
                        )
                    ]
                },

                "tips_key": "segments"
            },

            # üü° –§–û–†–ú–ê: ratio_by_similarity
            "ratio_by_similarity": {
                "idea": (
                    "–ï—Å–ª–∏ –ø—Ä—è–º–∞—è <b>MN</b> –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ <b>AC</b>, —Ç–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏ "
                    "<b>MBN</b> –∏ <b>ABC</b> –ø–æ–¥–æ–±–Ω—ã: <b>ŒîMBN ~ ŒîABC</b>.\n"
                    "–û—Ç–Ω–æ—à–µ–Ω–∏–µ –∏—Ö –ø–ª–æ—â–∞–¥–µ–π —Ä–∞–≤–Ω–æ <b>–ö–í–ê–î–†–ê–¢–£</b> –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø–æ–¥–æ–±–∏—è:\n"
                    "<b>S(MBN) / S(ABC) = k¬≤</b>"
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n"
                        "{if s_mbn_val}–î–∞–Ω–æ: <b>S(MBN) = {s_mbn_val}</b>{endif}{if s_abc_val}, <b>S(ABC) = {s_abc_val}</b>{endif}{if k_val} <b>k = {k_val}</b>{endif}.\n"
                        "–ù–∞–π—Ç–∏: <b>{to_find_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –£—Å—Ç–∞–Ω–æ–≤–∏–º —Ñ–∞–∫—Ç –ø–æ–¥–æ–±–∏—è.\n"
                        "–¢–∞–∫ –∫–∞–∫ <b>MN ‚à• AC</b>, —Ç–æ <b>ŒîMBN ~ ŒîABC</b>."
                    ),
                    (
                        "{if s_mbn_val}{if s_abc_val}"
                        "<b>–®–∞–≥ 3.</b> –ù–∞–π–¥—ë–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è.\n"
                        "‚û°Ô∏è <b>k¬≤ = S(MBN) / S(ABC) = {s_mbn_val} / {s_abc_val}</b>\n"
                        "<b>k = ‚àö(S(MBN) / S(ABC)) = {k_val}</b>"
                        "{endif}{endif}"
                    ),
                    (
                        "{if not s_mbn_val}"
                        "<b>–®–∞–≥ 3.</b> –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è —É–∂–µ –∏–∑–≤–µ—Å—Ç–µ–Ω.\n"
                        "‚û°Ô∏è <b>k = {k_val}</b>"
                        "{endif}"
                    ),
                    (
                        "<b>–®–∞–≥ 4.</b> –ó–∞–ø–∏—à–µ–º –∏—Å–∫–æ–º–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ.\n"
                        "‚û°Ô∏è <b>{to_find_name} = {ratio_str}</b>"
                    ),
                ],
                "tips_key": "ratio"
            },
        },

        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": {
            "area": [
                "–ù–ï –ó–ê–ë–£–î–¨ –ö–í–ê–î–†–ê–¢! –°—Ç–æ—Ä–æ–Ω—ã –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫–∞–∫ <b>k</b>, –∞ –ø–ª–æ—â–∞–¥–∏ ‚Äî –∫–∞–∫ <b>k¬≤</b>.",
                "¬´–ü–æ–¥–æ–±–Ω–æ–µ –∫ –ø–æ–¥–æ–±–Ω–æ–º—É¬ª: –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è ‚Äî —ç—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ "
                "—Å—Ç–æ—Ä–æ–Ω—ã –º–∞–ª–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Å—Ç–æ—Ä–æ–Ω–µ –±–æ–ª—å—à–æ–≥–æ.",
                "–ß–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π: –µ—Å–ª–∏ <b>MN</b> ‚Äî —Å—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è, —Ç–æ <b>k = 1/2</b>, "
                "–∞ <b>k¬≤ = 1/4</b>. –ü–ª–æ—â–∞–¥—å –º–∞–ª–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –≤ 4 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ."
            ],
            "segments": [
                "–ï—Å–ª–∏ –≤ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –ø—Ä—è–º–∞—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞ –æ–¥–Ω–æ–π –∏–∑ —Å—Ç–æ—Ä–æ–Ω, —Ç–æ –æ–±—Ä–∞–∑—É–µ—Ç—Å—è –ø–∞—Ä–∞ –ø–æ–¥–æ–±–Ω—ã—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤.",
                "–í –ø–æ–¥–æ–±–Ω—ã—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞—Ö <b>–æ—Ç–Ω–æ—à–µ–Ω–∏—è –≤—Å–µ—Ö —Å—Ö–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω –æ–¥–∏–Ω–∞–∫–æ–≤—ã</b>.",
                "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è —É–¥–æ–±–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –ø–æ —Ç–µ–º —Å—Ç–æ—Ä–æ–Ω–∞–º, –¥–ª–∏–Ω—ã –∫–æ—Ç–æ—Ä—ã—Ö –∏–∑–≤–µ—Å—Ç–Ω—ã –∏–∑ —É—Å–ª–æ–≤–∏—è.",
                "–ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–∞ —á–∞—Å—Ç—å —Å—Ç–æ—Ä–æ–Ω—ã, —Å–Ω–∞—á–∞–ª–∞ –Ω–∞—Ö–æ–¥—è—Ç —ç—Ç—É —á–∞—Å—Ç—å, –∞ –∑–∞—Ç–µ–º <b>–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –≤—Å—é —Å—Ç–æ—Ä–æ–Ω—É</b>.",
                "–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫, –≤—Å–µ–≥–¥–∞ –ø–æ–ª–µ–∑–Ω–æ —Å–Ω–∞—á–∞–ª–∞ <b>–æ–±–æ–∑–Ω–∞—á–∏—Ç—å, –∫–∞–∫–∏–µ —Å—Ç–æ—Ä–æ–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥—É</b>."
            ],
            "ratio": [
                "–û—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω –ø–æ–¥–æ–±–Ω—ã—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ —Ä–∞–≤–Ω–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—É –ø–æ–¥–æ–±–∏—è <b>k</b>.",
                "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø–æ–¥–æ–±–∏—è –Ω–∞—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –ø–ª–æ—â–∞–¥–∏: "
                "<b>k = ‚àö(S(–º–∞–ª–µ–Ω—å–∫–æ–≥–æ) / S(–±–æ–ª—å—à–æ–≥–æ))</b>.",
                "–ë—É–¥—å –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω: <b>MN : AC</b> –∏ <b>AC : MN</b> ‚Äî —ç—Ç–æ –æ–±—Ä–∞—Ç–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è."
            ]
        }
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 2.4: triangle_area_by_midpoints
    # -------------------------------------------------------------------------
    "triangle_area_by_midpoints": {
        "idea": (
            "–¢–æ—á–∫–∏ <b>M –∏ N</b> ‚Äî —Å–µ—Ä–µ–¥–∏–Ω—ã —Å—Ç–æ—Ä–æ–Ω <b>AB –∏ BC</b>, –∑–Ω–∞—á–∏—Ç\n"
            "–æ—Ç—Ä–µ–∑–æ–∫ <b>MN</b> ‚Äî —Å—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ <b>ABC</b>.\n"
            "üîπ –°—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è –¥–µ–ª–∏—Ç —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –Ω–∞:\n"
            "–º–∞–ª–µ–Ω—å–∫–∏–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ <b>MBN</b>,\n"
            "–∏ —á–µ—Ç—ã—Ä—ë—Ö—É–≥–æ–ª—å–Ω–∏–∫ <b>AMNC</b> (—Ç—Ä–∞–ø–µ—Ü–∏—é).\n"
            "üìê –¢—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∏ <b>MBN –∏ ABC</b> –ø–æ–¥–æ–±–Ω—ã,\n"
            "–∞ —Å—Ç–æ—Ä–æ–Ω—ã –º–∞–ª–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –≤ 2 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ —Å—Ç–æ—Ä–æ–Ω –±–æ–ª—å—à–æ–≥–æ.\n"
            "–û—Ç—Å—é–¥–∞ —Å—Ä–∞–∑—É —Å–ª–µ–¥—É—é—Ç –≤–∞–∂–Ω—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è:\n"
            "‚Ä¢ <b>S(MBN) = 1/4 ¬∑ S(ABC)</b>\n"
            "–º–∞–ª–µ–Ω—å–∫–∏–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ ‚Äî —ç—Ç–æ —á–µ—Ç–≤–µ—Ä—Ç—å –±–æ–ª—å—à–æ–≥–æ\n"
            "‚Ä¢ <b>S(AMNC) = 3/4 ¬∑ S(ABC)</b>\n"
            "—Ç—Ä–∞–ø–µ—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç —Ç—Ä–∏ —á–µ—Ç–≤–µ—Ä—Ç–∏ –ø–ª–æ—â–∞–¥–∏\n"
            "‚Ä¢ <b>S(AMNC) = 3 ¬∑ S(MBN)</b>\n"
            "—Ç—Ä–∞–ø–µ—Ü–∏—è –≤ 3 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –º–∞–ª–µ–Ω—å–∫–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞\n"
            "üìå –≠—Ç–∏ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –ª—é–±—É—é –∏—Å–∫–æ–º—É—é –ø–ª–æ—â–∞–¥—å –≤ 1‚Äì2 —à–∞–≥–∞."
        ),
        "narratives": {
            # --- –ù–û–í–ê–Ø –§–û–†–ú–ê –î–õ–Ø –ó–ê–î–ê–ß–ò-–õ–û–í–£–®–ö–ò ---
            "find_midsegment_length": {
                "idea": (
                    "–ó–∞–¥–∞—á–∞ –Ω–∞ –ø—Ä—è–º–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ <b>—Ç–µ–æ—Ä–µ–º—ã –æ —Å—Ä–µ–¥–Ω–µ–π –ª–∏–Ω–∏–∏</b>.\n"
                    "–ü–æ—Å–∫–æ–ª—å–∫—É <b>M –∏ N</b> ‚Äî —Å–µ—Ä–µ–¥–∏–Ω—ã —Å—Ç–æ—Ä–æ–Ω, –æ—Ç—Ä–µ–∑–æ–∫ <b>MN</b> —è–≤–ª—è–µ—Ç—Å—è <b>—Å—Ä–µ–¥–Ω–µ–π –ª–∏–Ω–∏–µ–π</b> —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ <b>ABC</b>. "
                    "–ü–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é, –æ–Ω–∞ —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Å–µ—Ä–µ–¥–∏–Ω—ã –±–æ–∫–æ–≤—ã—Ö —Å—Ç–æ—Ä–æ–Ω –∏ <b>–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏—é AC</b>.\n"
                    "–ö–ª—é—á–µ–≤–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ: <b>—Å—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è —Ä–∞–≤–Ω–∞ –ø–æ–ª–æ–≤–∏–Ω–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è.</b>\n"
                    "<b>MN = 1/2 ¬∑ AC</b>\n"
                    "–ò –Ω–∞–æ–±–æ—Ä–æ—Ç,\n"
                    "<b>AC = 2 ¬∑ MN</b>\n"
                    "‚ùóÔ∏è<b>–í–∞–∂–Ω–æ: –≠—Ç–æ –∑–∞–¥–∞—á–∞-–ª–æ–≤—É—à–∫–∞.</b> –î–ª—è —Ä–µ—à–µ–Ω–∏—è –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ —Ç–∞ —Å—Ç–æ—Ä–æ–Ω–∞, –∫–æ—Ç–æ—Ä–æ–π —Å—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞. "
                    "–î–ª–∏–Ω—ã –¥—Ä—É–≥–∏—Ö —Å—Ç–æ—Ä–æ–Ω ‚Äî —ç—Ç–æ –∏–∑–±—ã—Ç–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –¥–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å."
                ),
                "steps_templates": [
                    (
                        "–ó–∞–ø–∏—à–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n"
                        "–î–∞–Ω–æ: "
                        "{if ac_val}<b>AC = {ac_val}</b>{endif}"
                        "{if ab_val}, <b>AB = {ab_val}</b>{endif}"
                        "{if bc_val}, <b>BC = {bc_val}</b>{endif}"
                        "{if mn_val}<b>MN = {mn_val}</b>{endif}.\n"
                        "–ù–∞–π—Ç–∏: <b>{to_find_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–∏–º–µ–Ω–∏–º —Ñ–æ—Ä–º—É–ª—É —Å—Ä–µ–¥–Ω–µ–π –ª–∏–Ω–∏–∏.\n"
                        "{if is_finding_mn}‚û°Ô∏è <b>MN = AC / 2 = {ac_val} / 2 = {res}</b>.{endif}"
                        "{if is_finding_ac}‚û°Ô∏è <b>AC = 2 ¬∑ MN = 2 ¬∑ {mn_val} = {res}</b>.{endif}"
                    )
                ],
                "tips_key": "midsegment_length"
            },

            "from_big_triangle:find_small_triangle": {
                "steps_templates": [
                    ("–ó–∞–ø–∏—à–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n–î–∞–Ω–æ: <b>S(ABC) = {s_abc_val}</b>.\n–ù–∞–π—Ç–∏: <b>S(MBN)</b>."),
                    ("<b>–®–∞–≥ 1.</b> –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª–æ ‚Ññ1.\n‚û°Ô∏è <b>S(MBN) = S(ABC) / 4</b>"),
                    ("<b>–®–∞–≥ 2.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª–∏–º.\n‚û°Ô∏è <b>S(MBN) = {s_abc_val} / 4 = {res}</b>.")
                ],
                "tips_key": "from_big"
            },
            "from_big_triangle:find_trapezoid": {
                "steps_templates": [
                    ("–ó–∞–ø–∏—à–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n–î–∞–Ω–æ: <b>S(ABC) = {s_abc_val}</b>.\n–ù–∞–π—Ç–∏: <b>S(AMNC)</b>."),
                    ("<b>–®–∞–≥ 1.</b> –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª–æ ‚Ññ2.\n‚û°Ô∏è <b>S(AMNC) = S(ABC) ¬∑ 3/4</b>"),
                    ("<b>–®–∞–≥ 2.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª–∏–º.\n‚û°Ô∏è <b>S(AMNC) = {s_abc_val} ¬∑ 3/4 = {res}</b>.")
                ],
                "tips_key": "from_big"
            },
            "from_small_triangle:find_big_triangle": {
                "steps_templates": [
                    ("–ó–∞–ø–∏—à–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n–î–∞–Ω–æ: <b>S(MBN) = {s_mbn_val}</b>.\n–ù–∞–π—Ç–∏: <b>S(ABC)</b>."),
                    ("<b>–®–∞–≥ 1.</b> –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª–æ ‚Ññ1 –≤ –æ–±—Ä–∞—Ç–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É.\n‚û°Ô∏è <b>S(ABC) = 4 ¬∑ S(MBN)</b>"),
                    ("<b>–®–∞–≥ 2.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª–∏–º.\n‚û°Ô∏è <b>S(ABC) = 4 ¬∑ {s_mbn_val} = {res}</b>.")
                ],
                "tips_key": "from_small"
            },
            "from_small_triangle:find_trapezoid": {
                "steps_templates": [
                    ("–ó–∞–ø–∏—à–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n–î–∞–Ω–æ: <b>S(MBN) = {s_mbn_val}</b>.\n–ù–∞–π—Ç–∏: <b>S(AMNC)</b>."),
                    (
                        "<b>–°–ø–æ—Å–æ–± 1 (–±—ã—Å—Ç—Ä—ã–π).</b>\n"
                        "<b>–®–∞–≥ 1.</b> –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª–æ ‚Ññ3, –Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑—ã–≤–∞—é—â–µ–µ —Ç—Ä–∞–ø–µ—Ü–∏—é –∏ –º–∞–ª—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫.\n"
                        "‚û°Ô∏è <b>S(AMNC) = 3 ¬∑ S(MBN)</b>\n\n"
                        "<b>–®–∞–≥ 2.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª–∏–º.\n"
                        "‚û°Ô∏è <b>S(AMNC) = 3 ¬∑ {s_mbn_val} = {res}</b>.\n\n"
                        "<b>–°–ø–æ—Å–æ–± 2 (–ø–æ–¥—Ä–æ–±–Ω—ã–π).</b>\n"
                        "<b>–®–∞–≥ 1.</b> –ó–Ω–∞—è –ø–ª–æ—â–∞–¥—å –º–∞–ª–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞, –Ω–∞–π–¥–µ–º –ø–ª–æ—â–∞–¥—å –±–æ–ª—å—à–æ–≥–æ.\n"
                        "‚û°Ô∏è <b>S(ABC) = 4 ¬∑ S(MBN) = 4 ¬∑ {s_mbn_val} = {s_abc_val}</b>.\n\n"
                        "<b>–®–∞–≥ 2.</b> –í—ã—á—Ç–µ–º –∏–∑ –ø–ª–æ—â–∞–¥–∏ –±–æ–ª—å—à–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –ø–ª–æ—â–∞–¥—å –º–∞–ª–æ–≥–æ, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –ø–ª–æ—â–∞–¥—å —Ç—Ä–∞–ø–µ—Ü–∏–∏.\n"
                        "‚û°Ô∏è <b>S(AMNC) = S(ABC) - S(MBN) = {s_abc_val} - {s_mbn_val} = {res}</b>.\n\n"
                        "–û–±–∞ —Å–ø–æ—Å–æ–±–∞ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –æ–¥–Ω–æ–º—É –æ—Ç–≤–µ—Ç—É."
                    )
                ],
                "tips_key": "from_small"
            },
            "from_trapezoid:find_big_triangle": {
                "steps_templates": [
                    ("–ó–∞–ø–∏—à–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n–î–∞–Ω–æ: <b>S(AMNC) = {s_amnc_val}</b>.\n–ù–∞–π—Ç–∏: <b>S(ABC)</b>."),
                    ("<b>–®–∞–≥ 1.</b> –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª–æ ‚Ññ2 –≤ –æ–±—Ä–∞—Ç–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É.\n‚û°Ô∏è <b>S(ABC) = S(AMNC) ¬∑ 4/3</b>"),
                    ("<b>–®–∞–≥ 2.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª–∏–º.\n‚û°Ô∏è <b>S(ABC) = {s_amnc_val} ¬∑ 4/3 = {res}</b>.")
                ],
                "tips_key": "from_trapezoid"
            },
            "from_trapezoid:find_small_triangle": {
                "steps_templates": [
                    ("–ó–∞–ø–∏—à–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n–î–∞–Ω–æ: <b>S(AMNC) = {s_amnc_val}</b>.\n–ù–∞–π—Ç–∏: <b>S(MBN)</b>."),
                    ("<b>–®–∞–≥ 1.</b> –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª–æ ‚Ññ3 –≤ –æ–±—Ä–∞—Ç–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É.\n‚û°Ô∏è <b>S(MBN) = S(AMNC) / 3</b>"),
                    ("<b>–®–∞–≥ 2.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤—ã—á–∏—Å–ª–∏–º.\n‚û°Ô∏è <b>S(MBN) = {s_amnc_val} / 3 = {res}</b>.")
                ],
                "tips_key": "from_trapezoid"
            }
        },
        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",
        "tips": {
            "midsegment_length": (
                "<tg-spoiler>\n"
                "üîπ –≠—Ç–æ –∑–∞–¥–∞—á–∞-–ª–æ–≤—É—à–∫–∞. –í—Å–µ–≥–¥–∞ –∏—â–∏ —Ç—É —Å—Ç–æ—Ä–æ–Ω—É, –∫–æ—Ç–æ—Ä–æ–π —Å—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è <b>–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞</b>. –¢–æ–ª—å–∫–æ –æ–Ω–∞ –Ω—É–∂–Ω–∞ –¥–ª—è —Ä–µ—à–µ–Ω–∏—è.\n"
                "üîπ –¢–µ–æ—Ä–µ–º–∞ –æ —Å—Ä–µ–¥–Ω–µ–π –ª–∏–Ω–∏–∏ ‚Äî –æ–¥–Ω–∞ –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –≤ –ø–ª–∞–Ω–∏–º–µ—Ç—Ä–∏–∏. –í—ã—É—á–∏ –µ–µ: \"–°—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞, —Å–æ–µ–¥–∏–Ω—è—é—â–∞—è —Å–µ—Ä–µ–¥–∏–Ω—ã –¥–≤—É—Ö —Å—Ç–æ—Ä–æ–Ω, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞ —Ç—Ä–µ—Ç—å–µ–π —Å—Ç–æ—Ä–æ–Ω–µ –∏ —Ä–∞–≤–Ω–∞ –µ–µ –ø–æ–ª–æ–≤–∏–Ω–µ\".\n"
                "üîπ –ù–µ –ø—ã—Ç–∞–π—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–æ—Ä–µ–º—É –ü–∏—Ñ–∞–≥–æ—Ä–∞ –∏–ª–∏ –∫–æ—Å–∏–Ω—É—Å–æ–≤. –ï—Å–ª–∏ –≤–∏–¥–∏—à—å \"—Å–µ—Ä–µ–¥–∏–Ω—ã —Å—Ç–æ—Ä–æ–Ω\" –∏ –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –æ—Ç—Ä–µ–∑–æ–∫ –º–µ–∂–¥—É –Ω–∏–º–∏ ‚Äî —ç—Ç–æ –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –∑–∞–¥–∞—á–∞ –Ω–∞ 1 –¥–µ–π—Å—Ç–≤–∏–µ.\n"
                "</tg-spoiler>"
            ),
            "from_big": (
                "<tg-spoiler>\n"
                "üîπ –°—Ä–µ–¥–Ω—è—è –ª–∏–Ω–∏—è –æ—Ç—Å–µ–∫–∞–µ—Ç —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫, –ø–ª–æ—â–∞–¥—å –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—Å–µ–≥–¥–∞ –≤ 4 —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ.\n"
                "üîπ –¢—Ä–∞–ø–µ—Ü–∏—è AMNC –≤—Å–µ–≥–¥–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 3/4 –ø–ª–æ—â–∞–¥–∏ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ ABC.\n"
                "üîπ –ï—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–∞ –ø–ª–æ—â–∞–¥—å –±–æ–ª—å—à–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ ‚Äî –∑–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è –≤ –æ–¥–Ω–æ –¥–µ–π—Å—Ç–≤–∏–µ.\n"
                "</tg-spoiler>"
            ),
            "from_small": (
                "<tg-spoiler>\n"
                "üîπ –ó–∞–ø–æ–º–Ω–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏—é –ø–ª–æ—â–∞–¥–µ–π: <b>1 : 3 : 4</b>. –≠—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ S(MBN) : S(AMNC) : S(ABC).\n"
                "üîπ –ú–µ—Ç–æ–¥ \"—á–∞—Å—Ç–µ–π\": –ï—Å–ª–∏ S(MBN) ‚Äî —ç—Ç–æ <b>1 —á–∞—Å—Ç—å</b>, —Ç–æ —Ç—Ä–∞–ø–µ—Ü–∏—è S(AMNC) ‚Äî —ç—Ç–æ <b>3 —á–∞—Å—Ç–∏</b>, –∞ –≤–µ—Å—å —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ S(ABC) ‚Äî —ç—Ç–æ <b>4 —á–∞—Å—Ç–∏</b>.\n"
                "</tg-spoiler>"
            ),
            "from_trapezoid": (
                "<tg-spoiler>\n"
                "üîπ –ú–µ—Ç–æ–¥ \"—á–∞—Å—Ç–µ–π\" ‚Äî —Ç–≤–æ–π –ª—É—á—à–∏–π –¥—Ä—É–≥. –ï—Å–ª–∏ –ø–ª–æ—â–∞–¥—å —Ç—Ä–∞–ø–µ—Ü–∏–∏ S(AMNC) ‚Äî —ç—Ç–æ <b>3 —á–∞—Å—Ç–∏</b>, —Ç–æ:\n"
                "üîπ –ü–ª–æ—â–∞–¥—å –º–∞–ª–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ S(MBN) ‚Äî —ç—Ç–æ <b>1 —á–∞—Å—Ç—å</b> (S(AMNC) / 3).\n"
                "üîπ –ü–ª–æ—â–∞–¥—å –≤—Å–µ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ S(ABC) ‚Äî —ç—Ç–æ <b>4 —á–∞—Å—Ç–∏</b> (S(AMNC) / 3 ¬∑ 4).\n"
                "</tg-spoiler>"
            )
        }
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 2.5: cosine_law_find_cos
    # -------------------------------------------------------------------------
    "cosine_law_find_cos": {
        "idea": (
            "–≠—Ç–∞ –∑–∞–¥–∞—á–∞ ‚Äî –ø—Ä—è–º–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ <b>–¢–µ–æ—Ä–µ–º—ã –∫–æ—Å–∏–Ω—É—Å–æ–≤</b>. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Ç–µ–æ—Ä–µ–º–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫: "
            "a¬≤ = b¬≤ + c¬≤ - 2bc ¬∑ cos(A). –ù–æ –¥–ª—è –Ω–∞—à–µ–π –∑–∞–¥–∞—á–∏ —É–¥–æ–±–Ω–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—É, –∫–æ—Ç–æ—Ä–∞—è —É–∂–µ –≤—ã—Ä–∞–∂–∞–µ—Ç –∫–æ—Å–∏–Ω—É—Å.\n"
            "<b>–ö–æ—Å–∏–Ω—É—Å —É–≥–ª–∞ —Ä–∞–≤–µ–Ω –¥—Ä–æ–±–∏: –≤ —á–∏—Å–ª–∏—Ç–µ–ª–µ ‚Äî —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –ø—Ä–∏–ª–µ–∂–∞—â–∏—Ö —Å—Ç–æ—Ä–æ–Ω –º–∏–Ω—É—Å –∫–≤–∞–¥—Ä–∞—Ç –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–µ–π —Å—Ç–æ—Ä–æ–Ω—ã; –≤ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ ‚Äî —É–¥–≤–æ–µ–Ω–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏–ª–µ–∂–∞—â–∏—Ö —Å—Ç–æ—Ä–æ–Ω.</b>\n\n"
            "–§–æ—Ä–º—É–ª–∞ –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è cos({target_angle}):\n"
            "<b>cos({target_angle}) = ({adj1_name}¬≤ + {adj2_name}¬≤ - {opp_name}¬≤) / (2 ¬∑ {adj1_name} ¬∑ {adj2_name})</b>\n"
            "–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: <b>–í—ã—á–∏—Ç–∞–µ–º –∫–≤–∞–¥—Ä–∞—Ç —Ç–æ–π —Å—Ç–æ—Ä–æ–Ω—ã, –∫–æ—Ç–æ—Ä–∞—è –ª–µ–∂–∏—Ç –Ω–∞–ø—Ä–æ—Ç–∏–≤ –∏—Å–∫–æ–º–æ–≥–æ —É–≥–ª–∞.</b>"
        ),
        "steps_templates": [
            (
                "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n"
                "–î–∞–Ω–æ: –°—Ç–æ—Ä–æ–Ω—ã <b>{adj1_name} = {adj1_val}</b>, <b>{adj2_name} = {adj2_val}</b>, <b>{opp_name} = {opp_val}</b>.\n"
                "–ù–∞–π—Ç–∏: <b>cos({target_angle})</b>."
            ),
            (
                "<b>–®–∞–≥ 2.</b> –û–ø—Ä–µ–¥–µ–ª–∏–º, –∫–∞–∫–∏–µ —Å—Ç–æ—Ä–æ–Ω—ã —è–≤–ª—è—é—Ç—Å—è \"–ø—Ä–∏–ª–µ–∂–∞—â–∏–º–∏\" –∫ —É–≥–ª—É {target_angle}, –∞ –∫–∞–∫–∞—è ‚Äî \"–ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–µ–π\".\n"
                "–ü—Ä–∏–ª–µ–∂–∞—â–∏–µ (–æ–±—Ä–∞–∑—É—é—Ç —É–≥–æ–ª {target_angle}): <b>{adj1_name}</b> –∏ <b>{adj2_name}</b>.\n"
                "–ü—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∞—è (–ª–µ–∂–∏—Ç –Ω–∞–ø—Ä–æ—Ç–∏–≤ —É–≥–ª–∞ {target_angle}): <b>{opp_name}</b>."
            ),
            (
                "<b>–®–∞–≥ 3.</b> –ó–∞–ø–∏—à–µ–º —Ñ–æ—Ä–º—É–ª—É —Ç–µ–æ—Ä–µ–º—ã –∫–æ—Å–∏–Ω—É—Å–æ–≤ –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è cos({target_angle}). –í—ã—á–∏—Ç–∞—Ç—å—Å—è –±—É–¥–µ—Ç –∫–≤–∞–¥—Ä–∞—Ç –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–µ–π —Å—Ç–æ—Ä–æ–Ω—ã {opp_name}.\n"
                "‚û°Ô∏è <b>cos({target_angle}) = ({adj1_name}¬≤ + {adj2_name}¬≤ - {opp_name}¬≤) / (2 ¬∑ {adj1_name} ¬∑ {adj2_name})</b>"
            ),
            (
                "<b>–®–∞–≥ 4.</b> –ê–∫–∫—É—Ä–∞—Ç–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª–∏–Ω —Å—Ç–æ—Ä–æ–Ω –≤ —Ñ–æ—Ä–º—É–ª—É.\n"
                "‚û°Ô∏è <b>cos({target_angle}) = ({numerator_calc_str}) / ({denominator_calc_str})</b>"
            ),
            (
                "<b>–®–∞–≥ 5.</b> –í—ã–ø–æ–ª–Ω–∏–º –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤ —á–∏—Å–ª–∏—Ç–µ–ª–µ –∏ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ.\n"
                "–ß–∏—Å–ª–∏—Ç–µ–ª—å: <b>{numerator_calc_str} = {numerator_res}</b>.\n"
                "–ó–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—å: <b>{denominator_calc_str} = {denominator_res}</b>."
            ),
            (
                "<b>–®–∞–≥ 6.</b> –ó–∞–ø–∏—à–µ–º –ø–æ–ª—É—á–µ–Ω–Ω—É—é –¥—Ä–æ–±—å –∏ —Å–æ–∫—Ä–∞—Ç–∏–º –µ–µ.\n"
                "‚û°Ô∏è <b>cos({target_angle}) = {numerator_res} / {denominator_res} = {final_fraction}</b>"
            ),
            (
                "<b>–®–∞–≥ 7.</b> –ü–µ—Ä–µ–≤–µ–¥–µ–º –¥—Ä–æ–±—å –≤ –¥–µ—Å—è—Ç–∏—á–Ω—ã–π –≤–∏–¥ –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ –æ—Ç–≤–µ—Ç.\n"
                "‚û°Ô∏è <b>{final_fraction} = {res}</b>"
            )
        ],
        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",
        "tips": [
            "\"–ú–∏–Ω—É—Å –∫–≤–∞–¥—Ä–∞—Ç –Ω–∞–ø—Ä–æ—Ç–∏–≤\" ‚Äî —ç—Ç–æ –≥–ª–∞–≤–Ω–∞—è –º–∞–Ω—Ç—Ä–∞ –¥–ª—è –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è —Ñ–æ—Ä–º—É–ª—ã.",
            "–ë—É–¥—å –ø—Ä–µ–¥–µ–ª—å–Ω–æ –≤–Ω–∏–º–∞—Ç–µ–ª–µ–Ω —Å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏. –≠—Ç–∞ –∑–∞–¥–∞—á–∞ –Ω–µ —Å–ª–æ–∂–Ω–∞—è –ø–æ –ª–æ–≥–∏–∫–µ, –Ω–æ —Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∫ –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–µ.",
            "<b>–ó–Ω–∞–∫ –∫–æ—Å–∏–Ω—É—Å–∞:</b>",
            "  - –ï—Å–ª–∏ cos –ø–æ–ª—É—á–∏–ª—Å—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º, —Ç–æ —É–≥–æ–ª –æ—Å—Ç—Ä—ã–π (< 90¬∞).",
            "  - –ï—Å–ª–∏ cos –ø–æ–ª—É—á–∏–ª—Å—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º, —Ç–æ —É–≥–æ–ª —Ç—É–ø–æ–π (> 90¬∞).",
            "  - –ï—Å–ª–∏ cos —Ä–∞–≤–µ–Ω –Ω—É–ª—é, —Ç–æ —É–≥–æ–ª –ø—Ä—è–º–æ–π (90¬∞).",
            "–≠—Ç–∞ —Ç–µ–æ—Ä–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è <b>–ª—é–±–æ–≥–æ</b> —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞, –Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–≥–æ."
        ]
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 2.6: triangle_by_two_angles_and_side
    # -------------------------------------------------------------------------
    "triangle_by_two_angles_and_side": {
        "narratives": {
            "default_sine_theorem": {
                "idea": (
                    "–≠—Ç–∞ –∑–∞–¥–∞—á–∞ ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ <b>–¢–µ–æ—Ä–µ–º—ã —Å–∏–Ω—É—Å–æ–≤</b>.\n"
                    "<b>–°—Ç–æ—Ä–æ–Ω—ã —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω—ã —Å–∏–Ω—É—Å–∞–º –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏—Ö —É–≥–ª–æ–≤.</b>\n"
                    "–§–æ—Ä–º—É–ª–∞: <b>a / sin‚à†A = b / sin‚à†B = c / sin‚à†C</b>"
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∏ –Ω–∞–π–¥–µ–º —Ç—Ä–µ—Ç–∏–π —É–≥–æ–ª.\n"
                        "–î–∞–Ω–æ: <b>{known_side_name} = {known_side_val}, ‚à†A = {angle_a_val}¬∞, ‚à†B = {angle_b_val}¬∞, ‚à†C = {angle_c_val}¬∞</b>.\n"
                        "–ù–∞–π—Ç–∏: <b>{to_find_name}</b>.\n"
                        "–°—É–º–º–∞ —É–≥–ª–æ–≤ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ <b>180¬∞</b>, –ø–æ—ç—Ç–æ–º—É —Ç—Ä–µ—Ç–∏–π —É–≥–æ–ª —Ä–∞–≤–µ–Ω: \n‚û°Ô∏è <b>180¬∞ - {angle_a_val}¬∞ - {angle_b_val}¬∞ = {angle_c_val}¬∞</b>."
                    ),
                    ("<b>–®–∞–≥ 2.</b> –ó–∞–ø–∏—à–µ–º —Ç–µ–æ—Ä–µ–º—É —Å–∏–Ω—É—Å–æ–≤:\n‚û°Ô∏è <b>BC / sin‚à†A = AC / sin‚à†B = AB / sin‚à†C</b>."),
                    (
                        "<b>–®–∞–≥ 3.</b> –í—ã–±–µ—Ä–µ–º –Ω—É–∂–Ω—É—é –ø—Ä–æ–ø–æ—Ä—Ü–∏—é.\n"
                        "–ò–∑–≤–µ—Å—Ç–Ω–∞—è –ø–∞—Ä–∞: —Å—Ç–æ—Ä–æ–Ω–∞ <b>{known_side_name}</b> –∏ —É–≥–æ–ª –Ω–∞–ø—Ä–æ—Ç–∏–≤ <b>‚à†{known_angle_name}</b>.\n"
                        "–ò—Å–∫–æ–º–∞—è –ø–∞—Ä–∞: —Å—Ç–æ—Ä–æ–Ω–∞ <b>{to_find_name}</b> –∏ —É–≥–æ–ª –Ω–∞–ø—Ä–æ—Ç–∏–≤ <b>‚à†{target_angle_name}</b>.\n"
                        "–ü—Ä–æ–ø–æ—Ä—Ü–∏—è: <b>{known_side_name} / sin‚à†{known_angle_name} = {to_find_name} / sin‚à†{target_angle_name}</b>"
                    ),
                    ("<b>–®–∞–≥ 4.</b> –í—ã—Ä–∞–∑–∏–º –∏—Å–∫–æ–º—É—é —Å—Ç–æ—Ä–æ–Ω—É.\n‚û°Ô∏è <b>{to_find_name} = ({known_side_name} ¬∑ sin‚à†{target_angle_name}) / sin‚à†{known_angle_name}</b>"),
                    ("<b>–®–∞–≥ 5.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –∏ –≤—ã—á–∏—Å–ª–∏–º.\n‚û°Ô∏è <b>{to_find_name} = ({known_side_val} ¬∑ {sin_target_angle}) / {sin_known_angle} = {res}</b>")
                ],
                "tips_key": "default"
            },
            "isosceles_triangle_trap": {
                "idea": (
                    "–≠—Ç–æ –∑–∞–¥–∞—á–∞ –Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–∏–ø–∞ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞. <b>–ï—Å–ª–∏ –≤ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –¥–≤–∞ —É–≥–ª–∞ —Ä–∞–≤–Ω—ã, —Ç–æ –æ–Ω —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω—ã–π.</b>\n"
                    "–í —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ —Å—Ç–æ—Ä–æ–Ω—ã, –ª–µ–∂–∞—â–∏–µ –Ω–∞–ø—Ä–æ—Ç–∏–≤ —Ä–∞–≤–Ω—ã—Ö —É–≥–ª–æ–≤, —Ç–æ–∂–µ —Ä–∞–≤–Ω—ã."
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É–≥–ª—ã.\n"
                        "–î–∞–Ω–æ: <b>‚à†{equal_angle_1} = {equal_angle_val}¬∞</b> –∏ <b>‚à†{equal_angle_2} = {equal_angle_val}¬∞</b>.\n"
                        "–í—ã–≤–æ–¥: —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω—ã–π."
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –ü—Ä–∏–º–µ–Ω–∏–º —Å–≤–æ–π—Å—Ç–≤–æ —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞.\n"
                        "–°—Ç–æ—Ä–æ–Ω—ã, –ª–µ–∂–∞—â–∏–µ –Ω–∞–ø—Ä–æ—Ç–∏–≤ —Ä–∞–≤–Ω—ã—Ö —É–≥–ª–æ–≤, —Ä–∞–≤–Ω—ã.\n"
                        "–°—Ç–æ—Ä–æ–Ω–∞ –Ω–∞–ø—Ä–æ—Ç–∏–≤ ‚à†{equal_angle_1} ‚Äî —ç—Ç–æ <b>{side_opposite_1}</b>.\n"
                        "–°—Ç–æ—Ä–æ–Ω–∞ –Ω–∞–ø—Ä–æ—Ç–∏–≤ ‚à†{equal_angle_2} ‚Äî —ç—Ç–æ <b>{side_opposite_2}</b>.\n"
                        # >>> –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ó–î–ï–°–¨ <<<
                        "‚û°Ô∏è <b>{side_opposite_1} = {side_opposite_2} = {known_equal_side_val}</b>."
                    ),
                    ("<b>–®–∞–≥ 3.</b> –ù–∞—Ö–æ–¥–∏–º –æ—Ç–≤–µ—Ç.\n‚û°Ô∏è <b>{to_find_name} = {res}</b>.")
                ],
                "tips_key": "isosceles"
            },
            "right_triangle_trap": {
                "idea": (
                    "–≠—Ç–æ –∑–∞–¥–∞—á–∞ –Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞. –ù–∞–π–¥—è —Ç—Ä–µ—Ç–∏–π —É–≥–æ–ª, –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –æ–Ω —Ä–∞–≤–µ–Ω 90¬∞. "
                    "–¢–∞–∫—É—é –∑–∞–¥–∞—á—É –º–æ–∂–Ω–æ –Ω–∞–¥–µ–∂–Ω–æ —Ä–µ—à–∏—Ç—å —á–µ—Ä–µ–∑ <b>–¢–µ–æ—Ä–µ–º—É —Å–∏–Ω—É—Å–æ–≤</b>, —Ç–∞–∫ –∫–∞–∫ sin90¬∞ = 1."
                ),
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1.</b> –ù–∞–π–¥–µ–º —Ç—Ä–µ—Ç–∏–π —É–≥–æ–ª –∏ –æ–ø—Ä–µ–¥–µ–ª–∏–º —Ç–∏–ø —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞.\n"
                        "–¢—Ä–µ—Ç–∏–π —É–≥–æ–ª = 180¬∞ - {angle_a_val}¬∞ - {angle_b_val}¬∞ = {angle_c_val}¬∞.\n"
                        "–í—ã–≤–æ–¥: –æ–¥–∏–Ω –∏–∑ —É–≥–ª–æ–≤ —Ä–∞–≤–µ–Ω 90¬∞, –∑–Ω–∞—á–∏—Ç, —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ <b>–ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –¢–∞–∫ –∫–∞–∫ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π, –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω—ã —É–¥–æ–±–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <b>–¢–µ–æ—Ä–µ–º—É —Å–∏–Ω—É—Å–æ–≤</b>.\n"
                        "–í—ã–±–µ—Ä–µ–º –Ω—É–∂–Ω—É—é –ø—Ä–æ–ø–æ—Ä—Ü–∏—é:\n‚û°Ô∏è <b>{known_side_name} / sin(‚à†{known_angle_name}) = {to_find_name} / sin(‚à†{target_angle_name})</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 3.</b> –í—ã—Ä–∞–∑–∏–º –∏—Å–∫–æ–º—É—é —Å—Ç–æ—Ä–æ–Ω—É –∏ –ø–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è.\n"
                        "‚û°Ô∏è <b>{to_find_name} = ({known_side_val} ¬∑ {sin_target_angle}) / {sin_known_angle} = {res}</b>"
                    )
                ],
                "tips_key": "right_30"
            }
        },
        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",
        "tips": {
            "default": [
                "\"–°—Ç–æ—Ä–æ–Ω–∞ - —É–≥–æ–ª –Ω–∞–ø—Ä–æ—Ç–∏–≤\" ‚Äî –≤—Å–µ–≥–¥–∞ –∏—â–∏ —ç—Ç–∏ –ø–∞—Ä—ã. –≠—Ç–æ –∫–ª—é—á –∫ —Ç–µ–æ—Ä–µ–º–µ —Å–∏–Ω—É—Å–æ–≤.",
                "–ü–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –Ω–∞–π–¥–∏ —Ç—Ä–µ—Ç–∏–π —É–≥–æ–ª! C = 180¬∞ - A - B. –≠—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è —Å–∞–º–æ–ø—Ä–æ–≤–µ—Ä–∫–∏.",
                "–í—ã—É—á–∏ —Ç–∞–±–ª–∏—Ü—É —Å–∏–Ω—É—Å–æ–≤ –¥–ª—è 30¬∞, 45¬∞, 60¬∞ –∏ –∏—Ö \"—Å–æ—Å–µ–¥–µ–π\" 120¬∞, 135¬∞, 150¬∞."
            ],
            "isosceles": [
                "–í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–π —Å –∞–Ω–∞–ª–∏–∑–∞ —É–≥–ª–æ–≤! –ï—Å–ª–∏ –≤–∏–¥–∏—à—å –¥–≤–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —É–≥–ª–∞ ‚Äî —ç—Ç–æ —Å–∞–º—ã–π –∫–æ—Ä–æ—Ç–∫–∏–π –ø—É—Ç—å –∫ —Ä–µ—à–µ–Ω–∏—é.",
                "–ü—Ä–∞–≤–∏–ª–æ: \"–ù–∞–ø—Ä–æ—Ç–∏–≤ —Ä–∞–≤–Ω—ã—Ö —É–≥–ª–æ–≤ –ª–µ–∂–∞—Ç —Ä–∞–≤–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã\" (–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç)."
            ],
            "right_30": [
                "–ï—Å–ª–∏ –ø–æ—Å–ª–µ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Ç—Ä–µ—Ç—å–µ–≥–æ —É–≥–ª–∞ —Ç—ã –≤–∏–¥–∏—à—å —É–≥–ª—ã 30¬∞ –∏ 90¬∞, –∑–Ω–∞—á–∏—Ç –ø–µ—Ä–µ–¥ —Ç–æ–±–æ–π –æ—Å–æ–±—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫.",
                "–í —Ç–∞–∫–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –∫–∞—Ç–µ—Ç, –ª–µ–∂–∞—â–∏–π –Ω–∞–ø—Ä–æ—Ç–∏–≤ —É–≥–ª–∞ 30¬∞, —Ä–∞–≤–µ–Ω –ø–æ–ª–æ–≤–∏–Ω–µ –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã.",
                "‚ö†Ô∏è –≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞ –∏–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–ª–∏–Ω–∞ –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã –∏ –∫–∞—Ç–µ—Ç–∞, –ª–µ–∂–∞—â–µ–≥–æ –Ω–∞–ø—Ä–æ—Ç–∏–≤ 30¬∞.",
                "üìå –°–≤–æ–π—Å—Ç–≤–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –≤ –æ–±—Ä–∞—Ç–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É: –µ—Å–ª–∏ –∫–∞—Ç–µ—Ç –≤ –¥–≤–∞ —Ä–∞–∑–∞ –º–µ–Ω—å—à–µ –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã, —Ç–æ —É–≥–æ–ª –Ω–∞–ø—Ä–æ—Ç–∏–≤ —ç—Ç–æ–≥–æ –∫–∞—Ç–µ—Ç–∞ —Ä–∞–≤–µ–Ω 30¬∞."
            ]
        }
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 2.7: trig_identity_find_trig_func
    # -------------------------------------------------------------------------
    "trig_identity_find_trig_func": {
        "narratives": {
            "find_sin_from_cos": {
                "idea": (
                    "–ó–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–∂–¥–µ—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä–æ–µ —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å–∏–Ω—É—Å –∏ –∫–æ—Å–∏–Ω—É—Å –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —É–≥–ª–∞:\n"
                    "<b>sin¬≤{angle_letter} + cos¬≤{angle_letter} = 1</b>\n"
                    "‚ùóÔ∏è –í–∞–∂–Ω–æ: –ø–æ —É—Å–ª–æ–≤–∏—é <b>—É–≥–æ–ª {angle_letter} ‚Äî –æ—Å—Ç—Ä—ã–π</b>. "
                    "–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏–Ω—É—Å–∞ –±–µ—Ä—ë—Ç—Å—è <b>–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º</b>."
                ),
                "steps_templates": [
                    ("<b>–®–∞–≥ 1.</b> –ó–∞–ø–∏—à–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ —Ç–æ–∂–¥–µ—Å—Ç–≤–æ.\n‚û°Ô∏è <b>sin¬≤{angle_letter} + cos¬≤{angle_letter} = 1</b>"),
                    ("<b>–®–∞–≥ 2.</b> –í—ã—Ä–∞–∑–∏–º –∏–∑ –Ω–µ–≥–æ <b>sin¬≤{angle_letter}</b>.\n‚û°Ô∏è <b>sin¬≤{angle_letter} = 1 - cos¬≤{angle_letter}</b>"),
                    ("<b>–®–∞–≥ 3.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ <b>cos{angle_letter} = {given_val}</b>.\n‚û°Ô∏è <b>sin¬≤{angle_letter} = 1 - ({given_val})¬≤</b>"),
                    ("<b>–®–∞–≥ 4.</b> –ê–∫–∫—É—Ä–∞—Ç–Ω–æ –≤–æ–∑–≤–µ–¥–µ–º –¥—Ä–æ–±—å –≤ –∫–≤–∞–¥—Ä–∞—Ç.\n‚û°Ô∏è <b>({given_val})¬≤ = {given_val_sq}</b>"),
                    ("<b>–®–∞–≥ 5.</b> –ù–∞–π–¥–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ <b>sin¬≤{angle_letter}</b>.\n‚û°Ô∏è <b>sin¬≤{angle_letter} = 1 - {given_val_sq} = {one_minus_sq}</b>"),
                    ("<b>–®–∞–≥ 6.</b> –ù–∞–π–¥–µ–º sin{angle_letter}, –∏–∑–≤–ª–µ–∫–∞—è –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å.\n‚û°Ô∏è <b>sin{angle_letter} = ‚àö({one_minus_sq}) = {final_fraction}</b>"),
                    ("<b>–®–∞–≥ 7.</b> –ü–µ—Ä–µ–≤–µ–¥–µ–º –¥—Ä–æ–±—å –≤ –¥–µ—Å—è—Ç–∏—á–Ω—ã–π –≤–∏–¥.\n‚û°Ô∏è <b>{final_fraction} = {res}</b>")
                ],
                "tips_key": "default"
            },
            "find_cos_from_sin": {
                "idea": (
                    "–ó–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ —Ç–æ–∂–¥–µ—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä–æ–µ —Å–≤—è–∑—ã–≤–∞–µ—Ç —Å–∏–Ω—É—Å –∏ –∫–æ—Å–∏–Ω—É—Å –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —É–≥–ª–∞:\n"
                    "<b>sin¬≤{angle_letter} + cos¬≤{angle_letter} = 1</b>\n"
                    "‚ùóÔ∏è –í–∞–∂–Ω–æ: –ø–æ —É—Å–ª–æ–≤–∏—é <b>—É–≥–æ–ª {angle_letter} ‚Äî –æ—Å—Ç—Ä—ã–π</b>. "
                    "–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ—Å–∏–Ω—É—Å–∞ –±–µ—Ä—ë—Ç—Å—è <b>–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º</b>."
                ),
                "steps_templates": [
                    ("<b>–®–∞–≥ 1.</b> –ó–∞–ø–∏—à–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–µ —Ç–æ–∂–¥–µ—Å—Ç–≤–æ.\n‚û°Ô∏è <b>sin¬≤{angle_letter} + cos¬≤{angle_letter} = 1</b>"),
                    ("<b>–®–∞–≥ 2.</b> –í—ã—Ä–∞–∑–∏–º –∏–∑ –Ω–µ–≥–æ <b>cos¬≤{angle_letter}</b>.\n‚û°Ô∏è <b>cos¬≤{angle_letter} = 1 - sin¬≤{angle_letter}</b>"),
                    ("<b>–®–∞–≥ 3.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ <b>sin{angle_letter} = {given_val}</b>. {if as_fraction_str}–£–¥–æ–±–Ω–µ–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–±—ã–∫–Ω–æ–≤–µ–Ω–Ω–æ–π –¥—Ä–æ–±—å—é: <b>{given_val} = {as_fraction_str}</b>.{endif}\n‚û°Ô∏è <b>cos¬≤{angle_letter} = 1 - ({as_fraction_str_for_calc})¬≤</b>"),
                    ("<b>–®–∞–≥ 4.</b> –í–æ–∑–≤–µ–¥–µ–º –¥—Ä–æ–±—å –≤ –∫–≤–∞–¥—Ä–∞—Ç.\n‚û°Ô∏è <b>({as_fraction_str_for_calc})¬≤ = {given_val_sq}</b>"),
                    ("<b>–®–∞–≥ 5.</b> –ù–∞–π–¥–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ <b>cos¬≤{angle_letter}</b>.\n‚û°Ô∏è <b>cos¬≤{angle_letter} = 1 - {given_val_sq} = {one_minus_sq}</b>"),
                    ("<b>–®–∞–≥ 6.</b> –ù–∞–π–¥–µ–º cos{angle_letter}, –∏–∑–≤–ª–µ–∫–∞—è –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å.\n‚û°Ô∏è <b>cos{angle_letter} = ‚àö({one_minus_sq}) = {final_fraction}</b>"),
                    ("<b>–®–∞–≥ 7.</b> –ü–µ—Ä–µ–≤–µ–¥–µ–º –¥—Ä–æ–±—å –≤ –¥–µ—Å—è—Ç–∏—á–Ω—ã–π –≤–∏–¥.\n‚û°Ô∏è <b>{final_fraction} = {res}</b>")
                ],
                "tips_key": "default"
            }
        },
        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",
        "tips": {
            "default": (
                "<tg-spoiler>\n"
                "üîπ <b>sin¬≤A + cos¬≤A = 1</b> ‚Äî —ç—Ç–æ –≥–ª–∞–≤–Ω–æ–µ —Ç–æ–∂–¥–µ—Å—Ç–≤–æ —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏–∏, –µ–≥–æ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –Ω–∞–∏–∑—É—Å—Ç—å.\n"
                "üîπ –ü–æ—Å–∫–æ–ª—å–∫—É –≤ –∑–∞–¥–∞—á–∞—Ö –û–ì–≠ —É–≥–æ–ª –≤—Å–µ–≥–¥–∞ –æ—Å—Ç—Ä—ã–π, —Å–∏–Ω—É—Å –∏ –∫–æ—Å–∏–Ω—É—Å –±—É–¥—É—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏.\n"
                "üîπ –ü–∏—Ñ–∞–≥–æ—Ä–æ–≤—ã —Ç—Ä–æ–π–∫–∏ –º–æ–≥—É—Ç —É—Å–∫–æ—Ä–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ: –µ—Å–ª–∏ cos = 3/5, —Ç—ã —Å—Ä–∞–∑—É –∑–Ω–∞–µ—à—å, —á—Ç–æ sin = 4/5 (—Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ 3-4-5).\n"
                "</tg-spoiler>"
            )
        }
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 2.8: triangle_medians_intersection
    # -------------------------------------------------------------------------
    "triangle_medians_intersection": {
        "idea": (
            "–ú–µ–¥–∏–∞–Ω–∞ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ ‚Äî —ç—Ç–æ –æ—Ç—Ä–µ–∑–æ–∫, —Å–æ–µ–¥–∏–Ω—è—é—â–∏–π –≤–µ—Ä—à–∏–Ω—É "
            "—Å —Å–µ—Ä–µ–¥–∏–Ω–æ–π –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω—ã.\n"
            "–í—Å–µ –º–µ–¥–∏–∞–Ω—ã —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ–π —Ç–æ—á–∫–µ "
            "–∏ –¥–µ–ª—è—Ç—Å—è —ç—Ç–æ–π —Ç–æ—á–∫–æ–π –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ <b>2:1</b>, —Å—á–∏—Ç–∞—è –æ—Ç –≤–µ—Ä—à–∏–Ω—ã.\n\n"
            "–≠—Ç–æ –∑–Ω–∞—á–∏—Ç:\n"
            "üîπ –æ—Ç—Ä–µ–∑–æ–∫ –æ—Ç –≤–µ—Ä—à–∏–Ω—ã –¥–æ —Ç–æ—á–∫–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è ‚Äî <b>2/3</b> –º–µ–¥–∏–∞–Ω—ã;\n"
            "üîπ –æ—Ç—Ä–µ–∑–æ–∫ –æ—Ç —Ç–æ—á–∫–∏ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –¥–æ —Å—Ç–æ—Ä–æ–Ω—ã ‚Äî <b>1/3</b> –º–µ–¥–∏–∞–Ω—ã."
        ),

        "narratives": {

            "find_large_part": {
                "steps_templates": [
                    (
                        "–ó–∞–ø–∏—à–µ–º –¥–∞–Ω–æ: {given_line}.\n"
                        "–ù–∞–π—Ç–∏: <b>{to_find_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–∏–º–µ–Ω–∏–º —Å–≤–æ–π—Å—Ç–≤–æ –º–µ–¥–∏–∞–Ω.\n"
                        "–ò—Å–∫–æ–º—ã–π –æ—Ç—Ä–µ–∑–æ–∫ <b>{to_find_name}</b> ‚Äî —ç—Ç–æ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –º–µ–¥–∏–∞–Ω—ã "
                        "<b>{whole_median}</b>, –æ–Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç <b>2/3</b> –æ—Ç –≤—Å–µ–π –¥–ª–∏–Ω—ã."
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –í—ã—á–∏—Å–ª–∏–º.\n"
                        "‚û°Ô∏è <b>{to_find_name} = 2/3 ¬∑ {whole_median} = 2/3 ¬∑ {given_median_val} = {res}</b>."
                    )
                ]
            },

            "find_small_part": {
                "steps_templates": [
                    (
                        "–ó–∞–ø–∏—à–µ–º –¥–∞–Ω–æ: {given_line}.\n"
                        "–ù–∞–π—Ç–∏: <b>{to_find_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–∏–º–µ–Ω–∏–º —Å–≤–æ–π—Å—Ç–≤–æ –º–µ–¥–∏–∞–Ω.\n"
                        "–ò—Å–∫–æ–º—ã–π –æ—Ç—Ä–µ–∑–æ–∫ <b>{to_find_name}</b> ‚Äî —ç—Ç–æ –º–µ–Ω—å—à–∞—è —á–∞—Å—Ç—å –º–µ–¥–∏–∞–Ω—ã "
                        "<b>{whole_median}</b>, –æ–Ω–∞ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç <b>1/3</b> –æ—Ç –≤—Å–µ–π –¥–ª–∏–Ω—ã."
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –í—ã—á–∏—Å–ª–∏–º.\n"
                        "‚û°Ô∏è <b>{to_find_name} = 1/3 ¬∑ {whole_median} = 1/3 ¬∑ {given_median_val} = {res}</b>."
                    )
                ]
            },

            "find_whole_median": {
                "steps_templates": [
                    (
                        "–ó–∞–ø–∏—à–µ–º –¥–∞–Ω–æ: {given_line}.\n"
                        "–ù–∞–π—Ç–∏: <b>{to_find_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 1.</b> –ü—Ä–∏–º–µ–Ω–∏–º —Å–≤–æ–π—Å—Ç–≤–æ –º–µ–¥–∏–∞–Ω.\n"
                        "{given_part_explanation}"
                    ),
                    (
                        "<b>–®–∞–≥ 2.</b> –í—ã—Ä–∞–∑–∏–º –≤—Å—é –º–µ–¥–∏–∞–Ω—É –∏ –≤—ã—á–∏—Å–ª–∏–º.\n"
                        "{calculation_line}"
                    )
                ]
            }
        },

        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": (
            "<tg-spoiler>\n"
            "üîπ –ó–∞–ø–æ–º–Ω–∏ –ø—Ä–∞–≤–∏–ª–æ: <b>2 : 1, —Å—á–∏—Ç–∞—è –æ—Ç –≤–µ—Ä—à–∏–Ω—ã</b>.\n"
            "üîπ –ë–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –º–µ–¥–∏–∞–Ω—ã = <b>2/3</b> –≤—Å–µ–π –¥–ª–∏–Ω—ã.\n"
            "üîπ –ú–∞–ª–∞—è —á–∞—Å—Ç—å –º–µ–¥–∏–∞–Ω—ã = <b>1/3</b> –≤—Å–µ–π –¥–ª–∏–Ω—ã.\n"
            "üîπ –í—Ç–æ—Ä–∞—è –º–µ–¥–∏–∞–Ω–∞ —á–∞—Å—Ç–æ –¥–∞–Ω–∞ –¥–ª—è –æ—Ç–≤–ª–µ—á–µ–Ω–∏—è ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—É—é.\n"
            "</tg-spoiler>"
        )
    },

    # =========================================================================
    # –¢–ï–ú–ê 3: –†–ê–í–ù–û–ë–ï–î–†–ï–ù–ù–´–ô –ò –†–ê–í–ù–û–°–¢–û–†–û–ù–ù–ò–ô –¢–†–ï–£–ì–û–õ–¨–ù–ò–ö
    # =========================================================================

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 3.1: isosceles_triangle_angles
    # -------------------------------------------------------------------------
    "isosceles_triangle_angles": {
        "idea": (
            "–í—Å—è –∑–∞–¥–∞—á–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –¥–≤—É—Ö –Ω–µ–∑—ã–±–ª–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤–∞—Ö:\n"
            "<b>–£–≥–ª—ã –ø—Ä–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω—ã.</b>\n"
            "<b>–°—É–º–º–∞ –≤—Å–µ—Ö —É–≥–ª–æ–≤ –ª—é–±–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω–∞ 180¬∞.</b>\n"
        ),

        "narratives": {

            # üü° –§–û–†–ú–ê: –î–∞–Ω —É–≥–æ–ª –ø—Ä–∏ –≤–µ—Ä—à–∏–Ω–µ
            "find_base_angle": {
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                        "–î–∞–Ω–æ: –†–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω—ã–π <b>Œî{triangle_name}, {equal_sides}</b>.\n"
                        "–£–≥–æ–ª –ø—Ä–∏ –≤–µ—Ä—à–∏–Ω–µ <b>‚à†{vertex_name} = {vertex_angle}¬∞</b>.\n"
                        "–ù–∞–π—Ç–∏: –£–≥–æ–ª –ø—Ä–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ <b>‚à†{base_angle_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2</b>. –°—É–º–º–∞ —É–≥–ª–æ–≤ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω–∞ <b>180¬∞</b>:\n"
                        "‚û°Ô∏è <b>‚à†{base_angle_name} + ‚à†{vertex_name} + ‚à†{second_base_angle_name} = 180¬∞</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 3</b>. –í —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ —É–≥–ª—ã –ø—Ä–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Ä–∞–≤–Ω—ã:\n"
                        "‚û°Ô∏è <b>‚à†{base_angle_name} = ‚à†{second_base_angle_name}</b>\n"
                        "–ü–æ—ç—Ç–æ–º—É:\n"
                        "‚û°Ô∏è <b>‚à†{base_angle_name} + {vertex_angle}¬∞ + ‚à†{base_angle_name} = 180¬∞</b>\n"
                        "‚û°Ô∏è <b>2 ¬∑ ‚à†{base_angle_name} + {vertex_angle}¬∞ = 180¬∞</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 4</b>. –ù–∞—Ö–æ–¥–∏–º —É–≥–æ–ª –ø—Ä–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏:\n"
                        "‚û°Ô∏è <b>2 ¬∑ ‚à†{base_angle_name} = 180¬∞ - {vertex_angle}¬∞ = {two_base_sum}¬∞</b>\n"
                        "‚û°Ô∏è <b>‚à†{base_angle_name} = {two_base_sum}¬∞ / 2 = {res}¬∞</b>"
                    ),
                ],
            },

            # üü° –§–û–†–ú–ê: –î–∞–Ω —É–≥–æ–ª –ø—Ä–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏
            "find_vertex_angle": {
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                        "–î–∞–Ω–æ: <b>Œî{triangle_name}, {equal_sides}, ‚à†{base_angle_name} = {base_angle}¬∞</b>.\n"
                        "–ù–∞–π—Ç–∏: <b>‚à†{vertex_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2</b>. –£–≥–ª—ã –ø—Ä–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —Ä–∞–≤–Ω–æ–±–µ–¥—Ä–µ–Ω–Ω–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω—ã:\n"
                        "‚û°Ô∏è <b>‚à†{second_base_angle_name} = ‚à†{base_angle_name} = {base_angle}¬∞</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 3</b>. –°—É–º–º–∞ –≤—Å–µ—Ö —É–≥–ª–æ–≤ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω–∞ <b>180¬∞</b>:\n"
                        "‚û°Ô∏è <b>‚à†{vertex_name} + ‚à†{base_angle_name} + ‚à†{second_base_angle_name} = 180¬∞</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 4</b>. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ:\n"
                        "‚û°Ô∏è <b>‚à†{vertex_name} + {double_base}¬∞ = 180¬∞</b>\n"
                        "‚û°Ô∏è <b>‚à†{vertex_name} = 180¬∞ - {double_base}¬∞ = {res}¬∞</b>"
                    ),
                ],
            },
        },
        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": {
            "default": (
                "<tg-spoiler>"
                "–°–Ω–∞—á–∞–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–∏, –∫–∞–∫–æ–π —ç—Ç–æ —É–≥–æ–ª:\n"
                "–ø—Ä–∏ –≤–µ—Ä—à–∏–Ω–µ ‚Äî –æ–Ω –æ–¥–∏–Ω\n"
                "–ø—Ä–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ ‚Äî —Ç–∞–∫–∏—Ö —É–≥–ª–æ–≤ –¥–≤–∞, –∏ –æ–Ω–∏ —Ä–∞–≤–Ω—ã\n"
                "‚ö†Ô∏è –ï—Å–ª–∏ –Ω–∞—à—ë–ª —Å—É–º–º—É —É–≥–ª–æ–≤ –ø—Ä–∏ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ ‚Äî —Ä–∞–∑–¥–µ–ª–∏ –Ω–∞ 2. –ß–∞—Å—Ç–æ –≤ –æ—Ç–≤–µ—Ç –Ω—É–∂–µ–Ω –æ–¥–∏–Ω —É–≥–æ–ª.\n"
                "‚úÖ –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–ª–æ–∂–∏ –≤—Å–µ —Ç—Ä–∏ —É–≥–ª–∞ ‚Äî –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å—Å—è 180¬∞.\n"
                "üß≠ –ü–æ–¥—Å–∫–∞–∑–∫–∞:\n"
                "–≤–µ—Ä—à–∏–Ω–∞ ‚Äî –≥–¥–µ —Å—Ö–æ–¥—è—Ç—Å—è —Ä–∞–≤–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã,\n"
                "–æ—Å–Ω–æ–≤–∞–Ω–∏–µ ‚Äî —Ç—Ä–µ—Ç—å—è —Å—Ç–æ—Ä–æ–Ω–∞."
                "</tg-spoiler>"
            )
        },
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù: 3.2 equilateral_height_to_side
    # -------------------------------------------------------------------------
    "equilateral_height_to_side": {
        "idea": (
            "–ó–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –≥–æ—Ç–æ–≤—É—é —Ñ–æ—Ä–º—É–ª—É –¥–ª—è —Ä–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞:\n"
            "<b>–í—ã—Å–æ—Ç–∞ —Ä–∞–≤–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ, —É–º–Ω–æ–∂–µ–Ω–Ω–æ–π –Ω–∞ ‚àö3/2.</b>\n"
            "–§–æ—Ä–º—É–ª–∞:\n"
            "<b>h = a ¬∑ ‚àö3/2</b>\n"
            "–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ —Å—Ç–æ—Ä–æ–Ω—É, –≤—ã—Ä–∞–∑–∏–º –µ—ë –∏–∑ —Ñ–æ—Ä–º—É–ª—ã:\n"
            "<b>a = (2 ¬∑ h) / ‚àö3</b>"
        ),

        "narratives": {
            "find_side_by_height": {
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                        "–î–∞–Ω–æ: –†–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫. "
                        "–í—ã—Å–æ—Ç–∞ <b>h = {k}‚àö3</b>.\n"
                        "–ù–∞–π—Ç–∏: –°—Ç–æ—Ä–æ–Ω–∞ <b>a</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2</b>. –ó–∞–ø–∏—à–µ–º —Ñ–æ—Ä–º—É–ª—É –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Å—Ç–æ—Ä–æ–Ω—ã <b>a</b> —á–µ—Ä–µ–∑ –≤—ã—Å–æ—Ç—É <b>h</b>.\n"
                        "‚û°Ô∏è <b>a = (2 ¬∑ h) / ‚àö3</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 3</b>. –ü–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Å–æ—Ç—ã.\n"
                        "‚û°Ô∏è <b>a = (2 ¬∑ {k}‚àö3) / ‚àö3</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 4</b>. –í—ã–ø–æ–ª–Ω–∏–º –≤—ã—á–∏—Å–ª–µ–Ω–∏—è. <b>‚àö3</b> –≤ —á–∏—Å–ª–∏—Ç–µ–ª–µ –∏ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª–µ —Å–æ–∫—Ä–∞—â–∞–µ—Ç—Å—è.\n"
                        "‚û°Ô∏è <b>a = {res}</b>"
                    ),
                ],
            },
        },

        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": {
            "default": (
                "<tg-spoiler><b>–ú–∞–≥–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞:</b>\n"
                "–ï—Å–ª–∏ –≤—ã—Å–æ—Ç–∞ —Ä–∞–≤–Ω–∞ <b>k‚àö3</b>, —Ç–æ —Å—Ç–æ—Ä–æ–Ω–∞ —Ä–∞–≤–Ω–∞ <b>2k</b>.</tg-spoiler>"
            )
        },
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù: 3.3 equilateral_side_to_element
    # -------------------------------------------------------------------------

    "equilateral_side_to_element": {
        "idea": (
            "–ó–∞–¥–∞—á–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –¥–≤—É—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–≤–æ–π—Å—Ç–≤–∞—Ö "
            "—Ä–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞:\n"
            "<b>–í —Ä–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –≤—ã—Å–æ—Ç–∞, –º–µ–¥–∏–∞–Ω–∞ –∏ –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞, "
            "–ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ –∏–∑ –æ–¥–Ω–æ–π –≤–µ—Ä—à–∏–Ω—ã, —Å–æ–≤–ø–∞–¥–∞—é—Ç.</b> –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ "
            "–¥–ª—è –≤—Å–µ—Ö —Ç—Ä–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ —Ñ–æ—Ä–º—É–ª–∞.\n"
            "<b>–í—ã—Å–æ—Ç–∞ (–∞ –∑–Ω–∞—á–∏—Ç, –∏ –º–µ–¥–∏–∞–Ω–∞, –∏ –±–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞) —Å–≤—è–∑–∞–Ω–∞ —Å–æ —Å—Ç–æ—Ä–æ–Ω–æ–π "
            "<b>a</b> —Ñ–æ—Ä–º—É–ª–æ–π:</b>\n"
            "<b>h = (a ¬∑ ‚àö3) / 2</b>"
        ),

        "steps_templates": [
            (
                "<b>–®–∞–≥ 1.</b> –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                "–î–∞–Ω–æ: –†–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫. –°—Ç–æ—Ä–æ–Ω–∞ <b>a = {k}‚àö3</b>.\n"
                "–ù–∞–π—Ç–∏: {target_label_acc} <b>{target_symbol}</b>."
            ),
            (
                "{if target_is_not_height}"
                "<b>–®–∞–≥ 2.</b> –í—Å–ø–æ–º–Ω–∏–º –∫–ª—é—á–µ–≤–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ: –≤ —Ä–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ "
                "{target_label_lower} —Ä–∞–≤–Ω–∞ –≤—ã—Å–æ—Ç–µ.\n"
                "‚û°Ô∏è <b>{target_symbol} = h</b>\n"
                "–ó–Ω–∞—á–∏—Ç, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—É –¥–ª—è –≤—ã—Å–æ—Ç—ã, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ {target_label_acc_lower}."
                "{endif}"
            ),
            (
                "<b>–®–∞–≥ 3.</b> –ó–∞–ø–∏—à–µ–º —Ñ–æ—Ä–º—É–ª—É –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è {target_label_gen} "
                "<b>{target_symbol}</b> —á–µ—Ä–µ–∑ —Å—Ç–æ—Ä–æ–Ω—É <b>a</b>.\n"
                "‚û°Ô∏è <b>{target_symbol} = (a ¬∑ ‚àö3) / 2</b>"
            ),
            (
                "<b>–®–∞–≥ 4.</b> –ü–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑–≤–µ—Å—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω—ã –≤ —Ñ–æ—Ä–º—É–ª—É.\n"
                "‚û°Ô∏è <b>{target_symbol} = ({k}‚àö3 ¬∑ ‚àö3) / 2</b>"
            ),
            (
                "<b>–®–∞–≥ 5.</b> –í—ã–ø–æ–ª–Ω–∏–º –≤—ã—á–∏—Å–ª–µ–Ω–∏—è.\n"
                "–í —á–∏—Å–ª–∏—Ç–µ–ª–µ: ‚àö3 ¬∑ ‚àö3 = 3.\n"
                "‚û°Ô∏è <b>{target_symbol} = ({k} ¬∑ 3) / 2</b>\n"
                "‚û°Ô∏è <b>{target_symbol} = {k_times_3}/2 = {res}</b>"
            ),
        ],

        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": {
            "default": (
                "<tg-spoiler>\"–í—ã—Å–æ—Ç–∞ = –ú–µ–¥–∏–∞–Ω–∞ = –ë–∏—Å—Å–µ–∫—Ç—Ä–∏—Å–∞\" ‚Äî —ç—Ç–æ —Å—É–ø–µ—Ä—Å–∏–ª–∞ "
                "—Ä–∞–≤–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞. –ï—Å–ª–∏ –ø—Ä–æ—Å—è—Ç –Ω–∞–π—Ç–∏ —á—Ç–æ-—Ç–æ –∏–∑ —ç—Ç–æ–π —Ç—Ä–æ–π–∫–∏, ‚Äî "
                "–∑–Ω–∞–π, —á—Ç–æ —Ñ–æ—Ä–º—É–ª–∞ –≤—Å–µ–≥–¥–∞ –æ–¥–Ω–∞.\n"
                "–ü–æ–º–Ω–∏ —Ñ–æ—Ä–º—É–ª—É <b>h = a‚àö3 / 2</b> –Ω–∞–∏–∑—É—Å—Ç—å! –û–Ω–∞ –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö –≤ –≥–µ–æ–º–µ—Ç—Ä–∏–∏ –û–ì–≠.\n"
                "–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —Ñ–æ—Ä–º—É–ª—É –Ω–µ –ø–æ–º–Ω–∏—à—å? –ù–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç —Ç–µ–æ—Ä–µ–º–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞. "
                "–†–∏—Å—É–µ—à—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ —Å –≥–∏–ø–æ—Ç–µ–Ω—É–∑–æ–π <b>a</b> –∏ –∫–∞—Ç–µ—Ç–æ–º <b>a/2</b> "
                "–∏ –Ω–∞—Ö–æ–¥–∏—à—å –≤—Ç–æ—Ä–æ–π –∫–∞—Ç–µ—Ç <b>h</b>.</tg-spoiler>"
            )
        },
    },

    # =========================================================================
    # –¢–ï–ú–ê 4: –ü–†–Ø–ú–û–£–ì–û–õ–¨–ù–´–ô –¢–†–ï–£–ì–û–õ–¨–ù–ò–ö
    # =========================================================================
    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 4.1: right_triangle_angles_sum
    # -------------------------------------------------------------------------
    "right_triangle_angles_sum": {
        "idea": (
            "–í –ª—é–±–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ —Å—É–º–º–∞ —É–≥–ª–æ–≤ —Ä–∞–≤–Ω–∞ <b>180¬∞</b>.\n"
            "–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –æ–¥–∏–Ω —É–≥–æ–ª ‚Äî –ø—Ä—è–º–æ–π, –æ–Ω —Ä–∞–≤–µ–Ω <b>90¬∞</b>.\n\n"
            "–ó–Ω–∞—á–∏—Ç, –Ω–∞ –¥–≤–∞ –æ—Å—Ç—Ä—ã—Ö —É–≥–ª–∞ –æ—Å—Ç–∞—ë—Ç—Å—è:\n"
            "<b>180¬∞ ‚àí 90¬∞ = 90¬∞</b>.\n\n"
            "<b>–ö–ª—é—á–µ–≤–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ:</b>\n"
            "–°—É–º–º–∞ –æ—Å—Ç—Ä—ã—Ö —É–≥–ª–æ–≤ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞ –≤—Å–µ–≥–¥–∞ —Ä–∞–≤–Ω–∞ <b>90¬∞</b>.\n\n"
            "üëâ –ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –æ–¥–∏–Ω –æ—Å—Ç—Ä—ã–π —É–≥–æ–ª, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã—á–µ—Å—Ç—å –¥—Ä—É–≥–æ–π –∏–∑ <b>90¬∞</b>."
        ),

        "steps_templates": [
            (
                "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n"
                "–î–∞–Ω–æ: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫. –û–¥–∏–Ω –æ—Å—Ç—Ä—ã–π —É–≥–æ–ª = <b>{known_angle}¬∞</b>.\n"
                "–ù–∞–π—Ç–∏: –í—Ç–æ—Ä–æ–π –æ—Å—Ç—Ä—ã–π —É–≥–æ–ª."
            ),
            (
                "<b>–®–∞–≥ 2</b>. –°–≤–æ–π—Å—Ç–≤–æ.\n"
                "‚û°Ô∏è <b>–ü–µ—Ä–≤—ã–π –æ—Å—Ç—Ä—ã–π —É–≥–æ–ª + –í—Ç–æ—Ä–æ–π –æ—Å—Ç—Ä—ã–π —É–≥–æ–ª = 90¬∞</b>"
            ),
            (
                "<b>–®–∞–≥ 3</b>. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ.\n"
                "–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —É–≥–æ–ª, –≤—ã—á—Ç–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–π –∏–∑ <b>90</b>:\n"
                "‚û°Ô∏è <b>90 - {known_angle} = {res}</b>"
            ),
        ],

        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": {
            "default": (
                "<tg-spoiler>–ó–æ–ª–æ—Ç–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –î–∞–Ω –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫ –∏ –æ–¥–∏–Ω –æ—Å—Ç—Ä—ã–π —É–≥–æ–ª ‚Äî "
                "—Å—Ä–∞–∑—É –≤—ã—á–∏—Ç–∞–π –µ–≥–æ –∏–∑ <b>90</b>.\n"
                "–≠—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–¥–∞—á –≤ —ç–∫–∑–∞–º–µ–Ω–µ, –Ω–µ —Ç—Ä–∞—Ç—å –Ω–∞ –Ω–µ–µ –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.\n"
                "–í –±–ª–∞–Ω–∫ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ —ç–∫–∑–∞–º–µ–Ω–µ –Ω—É–∂–Ω–æ –≤–ø–∏—Å–∞—Ç—å —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ, –±–µ–∑ –∑–Ω–∞—á–∫–∞ –≥—Ä–∞–¥—É—Å–∞.</tg-spoiler>"
            )
        },
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 4.2: pythagoras_find_leg
    # -------------------------------------------------------------------------
    "pythagoras_find_leg": {
        "idea": (
            "–ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–æ—Ä–µ–º—É –ü–∏—Ñ–∞–≥–æ—Ä–∞ <b>c¬≤ = a¬≤ + b¬≤</b>. –ù–∞—à–∞ —Ü–µ–ª—å ‚Äî –Ω–∞–π—Ç–∏ –æ–¥–∏–Ω –∏–∑ –∫–∞—Ç–µ—Ç–æ–≤. "
            "–î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã—Ä–∞–∑–∏—Ç—å –µ–≥–æ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ—Ä–º—É–ª—ã.\n"
            "<b>–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –∫–≤–∞–¥—Ä–∞—Ç –∫–∞—Ç–µ—Ç–∞, –Ω—É–∂–Ω–æ –∏–∑ –∫–≤–∞–¥—Ä–∞—Ç–∞ –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã –í–´–ß–ï–°–¢–¨ –∫–≤–∞–¥—Ä–∞—Ç –¥—Ä—É–≥–æ–≥–æ –∫–∞—Ç–µ—Ç–∞.</b>\n"
            "–§–æ—Ä–º—É–ª–∞: <b>a¬≤ = c¬≤ - b¬≤</b>."
        ),

        "steps_templates": [
            (
                "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏.\n"
                "–î–∞–Ω–æ: –ì–∏–ø–æ—Ç–µ–Ω—É–∑–∞ <b>c = {c}</b>. –ö–∞—Ç–µ—Ç <b>b = {b}</b>.\n"
                "–ù–∞–π—Ç–∏: –ö–∞—Ç–µ—Ç <b>a</b>."
            ),
            (
                "<b>–°–ø–æ—Å–æ–± 1:</b>\n"
                "<b>–®–∞–≥ 2</b>. –ó–∞–ø–∏—à–µ–º —Ñ–æ—Ä–º—É–ª—É —Ç–µ–æ—Ä–µ–º—ã –ü–∏—Ñ–∞–≥–æ—Ä–∞, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—É—é –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∫–∞—Ç–µ—Ç–∞.\n"
                "‚û°Ô∏è <b>a¬≤ = c¬≤ - b¬≤</b>"
            ),
            (
                "<b>–®–∞–≥ 3</b>. –ü–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã –∏ –∫–∞—Ç–µ—Ç–∞ –≤ —Ñ–æ—Ä–º—É–ª—É.\n"
                "‚û°Ô∏è <b>a¬≤ = {c}¬≤ - {b}¬≤</b>\n"
                "‚û°Ô∏è <b>a¬≤ = {c_sq} - {b_sq} = {diff}</b>"
            ),
            (
                "<b>–®–∞–≥ 4</b>. –ò–∑–≤–ª–µ—á—ë–º –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å, –ø–æ–ª—å–∑—É—è—Å—å —Ç–∞–±–ª–∏—Ü–µ–π –∫–≤–∞–¥—Ä–∞—Ç–æ–≤.\n"
                "‚û°Ô∏è <b>a = ‚àö{diff} = {res}</b>"
            ),
            (
                "{if triple_name}"
                "\n<b>–°–ø–æ—Å–æ–± 2 (—á–µ—Ä–µ–∑ –ø–∏—Ñ–∞–≥–æ—Ä–æ–≤—ã —Ç—Ä–æ–π–∫–∏):</b>\n"

                # –í–ê–†–ò–ê–ù–¢ –ê: –û–±—ã—á–Ω–∞—è —Ç—Ä–æ–π–∫–∞ (–Ω–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω–∞—è)
                "{if not is_scaled}"
                "–í–∏–¥–∏–º –∏–∑ –¥–∞–Ω–æ —á–∏—Å–ª–∞ <b>{c} –∏ {b}</b> ‚Äî —ç—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–∞—è \"–ø–∏—Ñ–∞–≥–æ—Ä–æ–≤–∞ —Ç—Ä–æ–π–∫–∞\" <b>{triple_name}</b>."
                "{endif}"

                # –í–ê–†–ò–ê–ù–¢ –ë: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç—Ä–æ–π–∫–∞ (k > 1)
                "{if is_scaled}"
                "–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —á–∏—Å–ª–∞ <b>{c} –∏ {b}</b> –º–æ–∂–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –Ω–∞ <b>{k_factor}</b>:\n"
                "‚û°Ô∏è <b>{c} : {k_factor} = {base_hypotenuse_calc}</b> (–≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞)\n"
                "‚û°Ô∏è <b>{b} : {k_factor} = {base_leg_calc}</b> (–∫–∞—Ç–µ—Ç)\n"
                "–ú—ã –ø–æ–ª—É—á–∏–ª–∏ —á–∏—Å–ª–∞ –∏–∑ –±–∞–∑–æ–≤–æ–π —Ç—Ä–æ–π–∫–∏ <b>{triple_name}</b>. –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞—Ç–µ—Ç –≤ –Ω–µ–π —Ä–∞–≤–µ–Ω <b>{base_unknown_leg}</b>.\n"
                "–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –æ—Ç–≤–µ—Ç, —É–º–Ω–æ–∂–∏–º –µ–≥–æ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ <b>{k_factor}</b>:\n"
                "‚û°Ô∏è <b>a = {base_unknown_leg} ¬∑ {k_factor} = {res}</b>"
                "{endif}"

                "{endif}"
            )
        ],

        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": {
            "default": (
                "<tg-spoiler><b>–¢–µ–æ—Ä–µ–º–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞:</b>\n"
                "–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –∫–≤–∞–¥—Ä–∞—Ç –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã —Ä–∞–≤–µ–Ω —Å—É–º–º–µ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –∫–∞—Ç–µ—Ç–æ–≤.\n"
                "‚Ä¢ –ï—Å–ª–∏ –∏—â–µ–º <b>–≥–∏–ø–æ—Ç–µ–Ω—É–∑—É</b> ‚Äî —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –∫–≤–∞–¥—Ä–∞—Ç—ã –∫–∞—Ç–µ—Ç–æ–≤.\n"
                "‚Ä¢ –ï—Å–ª–∏ –∏—â–µ–º <b>–∫–∞—Ç–µ—Ç</b> ‚Äî –≤—ã—á–∏—Ç–∞–µ–º –∫–≤–∞–¥—Ä–∞—Ç –∫–∞—Ç–µ—Ç–∞ –∏–∑ –∫–≤–∞–¥—Ä–∞—Ç–∞ –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã.\n"
                "‚Ä¢ –í—ã—á–∏—Ç–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è <b>—Ç–æ–ª—å–∫–æ –∏–∑ –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã</b>.\n"
                "‚Ä¢ –í –∫–æ–Ω—Ü–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <b>–∏–∑–≤–ª–µ—á—å –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å</b>.\n\n"
                "<b>–ü–∏—Ñ–∞–≥–æ—Ä–æ–≤—ã —Ç—Ä–æ–π–∫–∏:</b>\n"
                "–ë–∞–∑–æ–≤—ã–µ: <b>3-4-5, 5-12-13, 8-15-17, 7-24-25, 20-21-29</b>.\n"
                "<b>–õ–∞–π—Ñ—Ö–∞–∫:</b> –¢—Ä–æ–π–∫–∏ –º–æ–∂–Ω–æ —É–º–Ω–æ–∂–∞—Ç—å! –ï—Å–ª–∏ —É–º–Ω–æ–∂–∏—Ç—å –≤—Å–µ —á–∏—Å–ª–∞ –Ω–∞ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —á–∏—Å–ª–æ, –ø–æ–ª—É—á–∏—Ç—Å—è –Ω–æ–≤–∞—è —Ç—Ä–æ–π–∫–∞.\n"
                "–ü—Ä–∏–º–µ—Ä: <b>3-4-5</b> —É–º–Ω–æ–∂–∞–µ–º –Ω–∞ 2 üëâ <b>6-8-10</b>.</tg-spoiler>"
            )
        },
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 4.3: pythagoras_find_hypotenuse
    # -------------------------------------------------------------------------
    "pythagoras_find_hypotenuse": {
        "idea": (
            "–í—Å—è –∑–∞–¥–∞—á–∞ —Ä–µ—à–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ–¥–Ω–æ–≥–æ –∏–∑ –≥–ª–∞–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≥–µ–æ–º–µ—Ç—Ä–∏–∏ ‚Äî —Ç–µ–æ—Ä–µ–º—ã –ü–∏—Ñ–∞–≥–æ—Ä–∞.\n"
            "<b>–í –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–æ–º —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–µ –∫–≤–∞–¥—Ä–∞—Ç –¥–ª–∏–Ω—ã –≥–∏–ø–æ—Ç–µ–Ω—É–∑—ã —Ä–∞–≤–µ–Ω —Å—É–º–º–µ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –∫–∞—Ç–µ—Ç–æ–≤.</b>\n"
            "–§–æ—Ä–º—É–ª–∞: <b>c¬≤ = a¬≤ + b¬≤</b>, –≥–¥–µ <b>c ‚Äî –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞, a –∏ b ‚Äî –∫–∞—Ç–µ—Ç—ã</b>.\n"
            "–ì–ª–∞–≤–Ω–æ–µ –Ω–µ –∑–∞–±—ã—Ç—å –≤ –∫–æ–Ω—Ü–µ –∏–∑–≤–ª–µ—á—å –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å, —á—Ç–æ–±—ã –Ω–∞–π—Ç–∏ <b>c</b>, –∞ –Ω–µ <b>c¬≤</b>."
        ),

        "steps_templates": [
            (
                "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                "–î–∞–Ω–æ: –ö–∞—Ç–µ—Ç <b>a = {a}</b>, –∫–∞—Ç–µ—Ç <b>b = {b}</b>.\n"
                "–ù–∞–π—Ç–∏: –ì–∏–ø–æ—Ç–µ–Ω—É–∑–∞ <b>c</b>."
            ),
            (
                "<b>–°–ø–æ—Å–æ–± 1:</b>\n"
                "<b>–®–∞–≥ 2</b>. –ó–∞–ø–∏—à–µ–º —Ñ–æ—Ä–º—É–ª—É –ø–æ —Ç–µ–æ—Ä–µ–º–µ –ü–∏—Ñ–∞–≥–æ—Ä–∞.\n"
                "‚û°Ô∏è <b>c¬≤ = a¬≤ + b¬≤</b>"
            ),
            (
                "<b>–®–∞–≥ 3</b>. –ü–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞—Ç–µ—Ç–æ–≤ –≤ —Ñ–æ—Ä–º—É–ª—É –∏ –≤—ã—á–∏—Å–ª–∏–º –∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ã.\n"
                "‚û°Ô∏è <b>c¬≤ = {a}¬≤ + {b}¬≤</b>\n"
                "‚û°Ô∏è <b>c¬≤ = {a_sq} + {b_sq} = {sum_sq}</b>"
            ),
            (
                "<b>–®–∞–≥ 4</b>. –ò–∑–≤–ª–µ—á—ë–º –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –∫–æ—Ä–µ–Ω—å, –ø–æ–ª—å–∑—É—è—Å—å —Ç–∞–±–ª–∏—Ü–µ–π –∫–≤–∞–¥—Ä–∞—Ç–æ–≤.\n"
                "‚û°Ô∏è <b>c = ‚àö{sum_sq} = {res}</b>"
            ),
            (
                "{if triple_name}"
                "\n<b>–°–ø–æ—Å–æ–± 2 (—á–µ—Ä–µ–∑ –ø–∏—Ñ–∞–≥–æ—Ä–æ–≤—ã —Ç—Ä–æ–π–∫–∏):</b>\n"

                # –í–ê–†–ò–ê–ù–¢ –ê: –û–±—ã—á–Ω–∞—è —Ç—Ä–æ–π–∫–∞
                "{if not is_scaled}"
                "–ò–∑ –¥–∞–Ω–æ –≤–∏–¥–∏–º —á–∏—Å–ª–∞ <b>{a} –∏ {b}</b> ‚Äî —ç—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–∞—è \"–ø–∏—Ñ–∞–≥–æ—Ä–æ–≤–∞ —Ç—Ä–æ–π–∫–∞\" <b>{triple_name}</b>."
                "{endif}"

                # –í–ê–†–ò–ê–ù–¢ –ë: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ç—Ä–æ–π–∫–∞
                "{if is_scaled}"
                "–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–∞—Ç–µ—Ç—ã <b>{a} –∏ {b}</b> –º–æ–∂–Ω–æ —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –Ω–∞ <b>{k_factor}</b>:\n"
                "<b>{a} : {k_factor} = {calc_leg1_base}</b>\n"
                "<b>{b} : {k_factor} = {calc_leg2_base}</b>\n"
                "–ú—ã –ø–æ–ª—É—á–∏–ª–∏ –∫–∞—Ç–µ—Ç—ã –∏–∑ –±–∞–∑–æ–≤–æ–π —Ç—Ä–æ–π–∫–∏ <b>{triple_name}</b>. –ì–∏–ø–æ—Ç–µ–Ω—É–∑–∞ –≤ –Ω–µ–π —Ä–∞–≤–Ω–∞ <b>{base_hyp_calc}</b>.\n"
                "–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –æ—Ç–≤–µ—Ç, —É–º–Ω–æ–∂–∏–º –µ—ë –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ <b>{k_factor}</b>:\n"
                "‚û°Ô∏è <b>c = {base_hyp_calc} ¬∑ {k_factor} = {res}</b>"
                "{endif}"

                "{endif}"
            )
        ],

        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": {
            "default": (
                "<tg-spoiler>\"–ù–µ –∑–∞–±—É–¥—å –∏–∑–≤–ª–µ—á—å –∫–æ—Ä–µ–Ω—å!\" ‚Äî —Å–∞–º–∞—è —á–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞ –≤ —ç—Ç–∏—Ö –∑–∞–¥–∞—á–∞—Ö. –ù–∞—Ö–æ–¥—è—Ç –∫–≤–∞–¥—Ä–∞—Ç –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç –µ–≥–æ –≤ –æ—Ç–≤–µ—Ç.\n"
                "–í—ã—É—á–∏ –Ω–∞–∏–∑—É—Å—Ç—å —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ \"–ø–∏—Ñ–∞–≥–æ—Ä–æ–≤—ã —Ç—Ä–æ–π–∫–∏\", —á—Ç–æ–±—ã —Ä–µ—à–∞—Ç—å —Ç–∞–∫–∏–µ –∑–∞–¥–∞—á–∏ –∑–∞ —Å–µ–∫—É–Ω–¥—ã:\n"
                "<b>3-4-5, 5-12-13, 6-8-10, 7-24-25, 8-15-17, 9-12-15, 12-16-20, 20-21-29.</b>\n"
                "–¢–µ–æ—Ä–µ–º–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã—Ö —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞—Ö.\n"
                "–ì–∏–ø–æ—Ç–µ–Ω—É–∑–∞ ‚Äî —ç—Ç–æ –≤—Å–µ–≥–¥–∞ —Å–∞–º–∞—è –¥–ª–∏–Ω–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞. –ï—Å–ª–∏ —Ç–≤–æ–π –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–∏–ª—Å—è –º–µ–Ω—å—à–µ –æ–¥–Ω–æ–≥–æ –∏–∑ –∫–∞—Ç–µ—Ç–æ–≤, –∑–Ω–∞—á–∏—Ç, –≥–¥–µ-—Ç–æ –æ—à–∏–±–∫–∞.</tg-spoiler>"
            )
        },
    },

    # -------------------------------------------------------------------------
    # –ü–ê–¢–¢–ï–†–ù 4.4: find_cos_sin_tg_from_sides
    # -------------------------------------------------------------------------
    "find_cos_sin_tg_from_sides": {
        "idea": (
            "–†–µ—à–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö —Ç—Ä–∏–≥–æ–Ω–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π:\n"
            "‚ùóÔ∏è <b>sin</b> ‚Äî –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞\n"
            "‚ùóÔ∏è <b>cos</b> ‚Äî –ø—Ä–∏–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞\n"
            "‚ùóÔ∏è <b>tg</b> ‚Äî –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –ø—Ä–∏–ª–µ–∂–∞—â–∏–π\n"
            "–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç ‚Äî –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–æ–π –∫–∞—Ç–µ—Ç —è–≤–ª—è–µ—Ç—Å—è \"–ø—Ä–∏–ª–µ–∂–∞—â–∏–º\", –∞ –∫–∞–∫–æ–π \"–ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–º\"."
        ),

        "narratives": {
            # ====================================================
            # –°–¶–ï–ù–ê–†–ò–ô 1: –ü—Ä—è–º–∞—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ (–ü–∏—Ñ–∞–≥–æ—Ä –Ω–µ –Ω—É–∂–µ–Ω)
            # ====================================================
            "direct": {
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                        "–î–∞–Ω–æ: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫, <b>‚à†{right_angle} = 90¬∞</b>.\n"
                        "{if given_hyp}–ì–∏–ø–æ—Ç–µ–Ω—É–∑–∞ <b>{hyp_name} = {given_hyp}</b>.{endif}"
                        "{if given_opp}–ö–∞—Ç–µ—Ç <b>{opp_name} = {given_opp}</b>.{endif}"
                        "{if given_adj}–ö–∞—Ç–µ—Ç <b>{adj_name} = {given_adj}</b>.{endif}\n"
                        "–ù–∞–π—Ç–∏: <b>{func_name} {angle}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2</b>. –í—Å–ø–æ–º–Ω–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.\n"
                        "{if is_sin}‚û°Ô∏è <b>sin {angle} = –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞</b>{endif}"
                        "{if is_cos}‚û°Ô∏è <b>cos {angle} = –ø—Ä–∏–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞</b>{endif}"
                        "{if is_tg}‚û°Ô∏è <b>tg {angle} = –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –ø—Ä–∏–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç</b>{endif}"
                    ),
                    (
                        "<b>–®–∞–≥ 3</b>. –î–ª—è —É–≥–ª–∞ <b>{angle}</b>:\n"
                        "–ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç ‚Äî <b>{opp_name}</b>,\n"
                        "–ø—Ä–∏–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç ‚Äî <b>{adj_name}</b>,\n"
                        "–≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞ ‚Äî <b>{hyp_name}</b>.\n"
                        "–í—Å–µ –Ω—É–∂–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –∏–∑–≤–µ—Å—Ç–Ω—ã."
                    ),
                    (
                        "<b>–®–∞–≥ 4</b>. –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º—É–ª—É:\n"
                        "‚û°Ô∏è <b>{func_name} {angle} = {num_name}/{den_name} = {num_val}/{den_val}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 5</b>. –í—ã—á–∏—Å–ª–∏–º –∏ –∑–∞–ø–∏—à–µ–º –æ—Ç–≤–µ—Ç:\n"
                        "‚û°Ô∏è <b>{num_val}/{den_val} = {res}</b>"
                    )
                ]
            },

            # ====================================================
            # –°–¶–ï–ù–ê–†–ò–ô 2: –ò—â–µ–º –≥–∏–ø–æ—Ç–µ–Ω—É–∑—É
            # ====================================================
            "calc_hyp": {
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                        "–î–∞–Ω–æ: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫, <b>‚à†{right_angle} = 90¬∞</b>.\n"
                        "–ö–∞—Ç–µ—Ç <b>{opp_name} = {given_opp}</b>.\n"
                        "–ö–∞—Ç–µ—Ç <b>{adj_name} = {given_adj}</b>.\n"
                        "–ù–∞–π—Ç–∏: <b>{func_name} {angle}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2</b>. –í—Å–ø–æ–º–Ω–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.\n"
                        "{if is_sin}‚û°Ô∏è <b>sin {angle} = –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞</b>{endif}"
                        "{if is_cos}‚û°Ô∏è <b>cos {angle} = –ø—Ä–∏–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞</b>{endif}\n"
                        "–ù–∞–º –Ω—É–∂–Ω–∞ –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞ <b>{hyp_name}</b>, –Ω–æ –æ–Ω–∞ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞."
                    ),
                    (
                        "<b>–®–∞–≥ 3</b>. –î–ª—è —É–≥–ª–∞ <b>{angle}</b>:\n"
                        "–ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç ‚Äî <b>{opp_name}</b>,\n"
                        "–ø—Ä–∏–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç ‚Äî <b>{adj_name}</b>,\n"
                        "–≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞ ‚Äî <b>{hyp_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 4</b>. –ù–∞–π–¥—ë–º –≥–∏–ø–æ—Ç–µ–Ω—É–∑—É –ø–æ —Ç–µ–æ—Ä–µ–º–µ –ü–∏—Ñ–∞–≥–æ—Ä–∞.\n"
                        "‚û°Ô∏è <b>{calc_step[formula]}</b>\n"
                        "‚û°Ô∏è <b>{calc_step[calc_str]}</b>\n"
                        "‚û°Ô∏è <b>–ì–∏–ø–æ—Ç–µ–Ω—É–∑–∞ {hyp_name} = {calc_step[res]}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 5</b>. –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º—É–ª—É:\n"
                        "‚û°Ô∏è <b>{func_name} {angle} = {num_name}/{den_name} = {num_val}/{den_val}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 6</b>. –í—ã—á–∏—Å–ª–∏–º –∏ –∑–∞–ø–∏—à–µ–º –æ—Ç–≤–µ—Ç:\n"
                        "‚û°Ô∏è <b>{num_val}/{den_val} = {res}</b>"
                    )
                ]
            },

            # ====================================================
            # –°–¶–ï–ù–ê–†–ò–ô 3: –ò—â–µ–º –∫–∞—Ç–µ—Ç
            # ====================================================
            "calc_leg": {
                "steps_templates": [
                    (
                        "<b>–®–∞–≥ 1</b>. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏:\n"
                        "–î–∞–Ω–æ: –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫, <b>‚à†{right_angle} = 90¬∞</b>.\n"
                        "–ì–∏–ø–æ—Ç–µ–Ω—É–∑–∞ <b>{hyp_name} = {given_hyp}</b>.\n"
                        "{if given_opp}–ö–∞—Ç–µ—Ç <b>{opp_name} = {given_opp}</b>.{endif}"
                        "{if given_adj}–ö–∞—Ç–µ—Ç <b>{adj_name} = {given_adj}</b>.{endif}\n"
                        "–ù–∞–π—Ç–∏: <b>{func_name} {angle}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 2</b>. –í—Å–ø–æ–º–Ω–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.\n"
                        "{if is_sin}‚û°Ô∏è <b>sin {angle} = –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞</b>{endif}"
                        "{if is_cos}‚û°Ô∏è <b>cos {angle} = –ø—Ä–∏–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞</b>{endif}"
                        "{if is_tg}‚û°Ô∏è <b>tg {angle} = –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç / –ø—Ä–∏–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç</b>{endif}\n"
                        "–ù–∞–º –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–ª–∏–Ω—ã –æ–¥–Ω–æ–≥–æ –∏–∑ –∫–∞—Ç–µ—Ç–æ–≤."
                    ),
                    (
                        "<b>–®–∞–≥ 3</b>. –î–ª—è —É–≥–ª–∞ <b>{angle}</b>:\n"
                        "–ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç ‚Äî <b>{opp_name}</b>,\n"
                        "–ø—Ä–∏–ª–µ–∂–∞—â–∏–π –∫–∞—Ç–µ—Ç ‚Äî <b>{adj_name}</b>,\n"
                        "–≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞ ‚Äî <b>{hyp_name}</b>."
                    ),
                    (
                        "<b>–®–∞–≥ 4</b>. –ù–∞–π–¥—ë–º –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞—Ç–µ—Ç –ø–æ —Ç–µ–æ—Ä–µ–º–µ –ü–∏—Ñ–∞–≥–æ—Ä–∞.\n"
                        "‚û°Ô∏è <b>{calc_step[formula]}</b>\n"
                        "‚û°Ô∏è <b>{calc_step[calc_str]}</b>\n"
                        "‚û°Ô∏è <b>–ö–∞—Ç–µ—Ç {calc_step[target_name]} = {calc_step[res]}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 5</b>. –ü–æ–¥—Å—Ç–∞–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º—É–ª—É:\n"
                        "‚û°Ô∏è <b>{func_name} {angle} = {num_name}/{den_name} = {num_val}/{den_val}</b>"
                    ),
                    (
                        "<b>–®–∞–≥ 6</b>. –í—ã—á–∏—Å–ª–∏–º –∏ –∑–∞–ø–∏—à–µ–º –æ—Ç–≤–µ—Ç:\n"
                        "‚û°Ô∏è <b>{num_val}/{den_val} = {res}</b>"
                    )
                ]
            }
        },

        "answer_template": "üéØ –û—Ç–≤–µ—Ç: <b>{res}</b>",

        "tips": {
            "default": (
                "<tg-spoiler>\n"
                "<b>–ü—Ä–∏–ª–µ–∂–∞—â–∏–π</b> –∏ <b>–ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π</b> ‚Äî —ç—Ç–æ —Ä–æ–ª—å –∫–∞—Ç–µ—Ç–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —É–≥–ª–∞.\n"
                "–°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—å: <b>–≤—Å–µ –ª–∏ —Å—Ç–æ—Ä–æ–Ω—ã –¥–ª—è —Ñ–æ—Ä–º—É–ª—ã –∏–∑–≤–µ—Å—Ç–Ω—ã</b>. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –Ω–∞—á–∏–Ω–∞–π —Å —Ç–µ–æ—Ä–µ–º—ã –ü–∏—Ñ–∞–≥–æ—Ä–∞.\n"
                "–ó–∞–ø–æ–º–Ω–∏ —Å–≤—è–∑–∏:\n"
                "sin = –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞\n"
                "cos = –ø—Ä–∏–ª–µ–∂–∞—â–∏–π / –≥–∏–ø–æ—Ç–µ–Ω—É–∑–∞\n"
                "tg = –ø—Ä–æ—Ç–∏–≤–æ–ª–µ–∂–∞—â–∏–π / –ø—Ä–∏–ª–µ–∂–∞—â–∏–π\n"
                "–í –û–ì–≠ –æ—Ç–≤–µ—Ç –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç <b>–∫–æ–Ω–µ—á–Ω–æ–π –¥–µ—Å—è—Ç–∏—á–Ω–æ–π –¥—Ä–æ–±—å—é</b>.\n"
                "</tg-spoiler>"
            )
        },
    },
}
# ---------------------------------------------------------------------------
# –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–µ—Ä)
# ---------------------------------------------------------------------------

def humanize(solution_core: List[Dict[str, Any]]) -> str:
    if not solution_core or not isinstance(solution_core, list):
        return "–û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏—è."

    scenario_data = solution_core[0]
    full_action = scenario_data.get("action")
    context = scenario_data.get("data", {})

    pattern, narrative = (
        full_action.split(":", 1)
        if ":" in full_action
        else (full_action, "default")
    )

    # ------------------------------------------------------------------
    # –ü–ï–†–ï–û–ü–†–ï–î–ï–õ–ï–ù–ò–ï narrative –¥–ª—è triangle_area_by_dividing_point
    # ------------------------------------------------------------------
    if pattern == "triangle_area_by_dividing_point":
        task_text = context.get("task_text", "")
        task_text_lower = task_text.lower() if isinstance(task_text, str) else ""

        has_total_area = "s_abc_val" in context
        has_small_area = (
            "s_abd_val" in context or "s_bcd_val" in context
        )

        asks_compare = any(
            word in task_text_lower
            for word in ["–±–æ–ª—å—à", "–º–µ–Ω—å—à", "–Ω–∞–∏–±–æ–ª—å—à", "–Ω–∞–∏–º–µ–Ω—å—à"]
        )

        if has_total_area and asks_compare:
            narrative = "compare_small_triangles"
        elif has_total_area and not has_small_area:
            narrative = "find_small_from_big"
        else:
            narrative = "find_from_small"

    scenario_group = TASK_15_SCENARIOS.get(pattern)
    if not scenario_group:
        return f"–®–∞–±–ª–æ–Ω —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ '{pattern}' –Ω–µ –Ω–∞–π–¥–µ–Ω."

    scenario = scenario_group.get("narratives", {}).get(narrative, scenario_group)
    if not scenario:
        return f"–°—Ü–µ–Ω–∞—Ä–∏–π '{narrative}' –¥–ª—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ '{pattern}' –Ω–µ –Ω–∞–π–¥–µ–Ω."

    parts = []

    # 1. –ò–¥–µ—è
    idea_text = scenario.get("idea") or scenario_group.get("idea")
    if idea_text:
        parts.append(f"üí° <b>–ò–¥–µ—è —Ä–µ—à–µ–Ω–∏—è:</b> {idea_text.format(**context)}")

    # 2. –®–∞–≥–∏
    parts.append("ü™ú <b>–ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ</b>")

    steps_templates = scenario["steps_templates"]

    # ‚úÖ –°–ü–ï–¶–ò–ê–õ–¨–ù–û –¢–û–õ–¨–ö–û –î–õ–Ø –ü–ê–¢–¢–ï–†–ù–ê 2.3
    if (
        pattern == "triangle_area_by_parallel_line"
        and narrative == "segments_by_similarity"
        and isinstance(steps_templates, dict)
    ):
        platform = context.get("platform")
        if not platform:
            return "–û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏—è: –Ω–µ —É–∫–∞–∑–∞–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞."

        steps_templates = steps_templates.get(platform)
        if not steps_templates:
            return f"–û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏—è: –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ '{platform}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞."

    # ‚¨áÔ∏è –û–ë–©–ò–ô –¶–ò–ö–õ (–†–ê–ë–û–¢–ê–ï–¢ –î–õ–Ø –í–°–ï–• –ü–ê–¢–¢–ï–†–ù–û–í)
    steps_html = []
    for step_template in steps_templates:
        processed_template = _apply_conditionals(step_template, context)
        try:
            rendered_step = processed_template.format(**context)
            steps_html.append(rendered_step)
        except KeyError as e:
            steps_html.append(f"<i>–û—à–∏–±–∫–∞ —à–∞–±–ª–æ–Ω–∞: –ø—Ä–æ–ø—É—â–µ–Ω –∫–ª—é—á {e}</i>")

    parts.append("\n\n".join(steps_html))

    # 3. –û—Ç–≤–µ—Ç
    if "answer_template" in scenario_group:
        parts.append(scenario_group["answer_template"].format(**context))

    # 4. –ü–æ–¥—Å–∫–∞–∑–∫–∏ (–£–º–Ω–∞—è –≤–µ—Ä—Å–∏—è)
    tips_key = scenario.get("tips_key", "default")
    if "tips" in scenario_group and tips_key in scenario_group["tips"]:
        tips_content = scenario_group["tips"][tips_key]

        # –ü–†–û–í–ï–†–ö–ê: tips_content - —ç—Ç–æ —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ –∏–ª–∏ –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞?
        if isinstance(tips_content, list):
            # –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ (–∫–∞–∫ –≤ –ü–∞—Ç—Ç–µ—Ä–Ω–µ 2.3)
            formatted_tips = [tip.format(**context) for tip in tips_content]
            tips_list = "\n".join(f"üîπ {t}" for t in formatted_tips)
            parts.append(f"‚ú® <b>–ü–æ–ª–µ–∑–Ω–æ –∑–Ω–∞—Ç—å</b>\n{tips_list}")

        elif isinstance(tips_content, str):
            # –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (–∫–∞–∫ –≤ –ü–∞—Ç—Ç–µ—Ä–Ω–µ 2.4 —Å–æ —Å–ø–æ–π–ª–µ—Ä–æ–º)
            formatted_tip = tips_content.format(**context)
            parts.append(f"‚ú® <b>–ü–æ–ª–µ–∑–Ω–æ –∑–Ω–∞—Ç—å</b>\n{formatted_tip}")

    return "\n\n".join(parts)
